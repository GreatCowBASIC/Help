<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Analog/Digital Conversion Overview</title><link rel="stylesheet" type="text/css" href="gcbdoc.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="GCBASIC documentation"><link rel="up" href="_analog_digital_conversion.html" title="Analog/Digital conversion"><link rel="prev" href="_analog_digital_conversion.html" title="Analog/Digital conversion"><link rel="next" href="_adformat_deprecated_do_not_use.html" title="ADFormat (Deprecated - Do not use)"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_analog_digital_conversion_overview"></a>Analog/Digital Conversion Overview</h4></div></div></div><p><span class="strong"><strong>About Analog to Digital Conversion</strong></span></p><p>The analog to digital converter (ADC or A/D) module support is implemented by GCBASIC to provide 8-bit, 10-bit and 12-bit Single channel measurement mode and Differential Channel Measurement mode.</p><p>GCBASIC configures the analog to digital converter clock source, the programmed acquisition time and justification of the response byte, word or integer (as defined in the GCBASIC method).</p><p><span class="strong"><strong>Normal or Single channel measurement mode</strong></span></p><p>The Single channel measurement mode is the default method for reading the ADC port.  The positive input is attached to suitable device (a light sensor or adjustable resistor) and the command ReadADC, ReadADC10, ReadADC12 with return a byte, word or word value respectively.</p><div class="informalfigure"><div class="mediaobject" align="center"><img src="./images/adcoverviewb1.PNG" align="middle" alt="graphic"></div></div><p>The A/D module on most microcontrollers only supports single-ended mode. Single channel mode uses a single A/D port and the returned Value represents the difference between the voltage on the analog pin and a fixed negative reference which is usually ground or Vss.</p><p>The syntax for single-ended A/D is Returned_Value = ReadAD(Port)</p><p>Example</p><pre class="screen">  Print ReadAD10(AN3)</pre><p><span class="strong"><strong>Differential channel measurement mode</strong></span></p><p>Some of the in the Microchip PIC family of devices also support differential analog to digital conversion. With differential conversion, the differential voltage between two channels is measured and converted to a digital value.  The returned value can be either positive or negative (therefore an integer value).</p><div class="informalfigure"><div class="mediaobject" align="center"><img src="./images/adcoverviewb2.PNG" align="middle" alt="graphic"></div></div><p>When configured to differential channel measurement mode, the positive channel is connected to the defined positive analog pin (ANx), and the negative channel is connected to the defined negative analog pin. These two pins are internally connected (within the microcontroller) to a unity gain differential amplifier and once the amplifier has completed the comparison the result is returned as an integer.</p><p>The positive channel Input is selected using the CHSx bits and the negative channel input is selected using the CHSNx bits.  These bits are managed by GCBASIC.  The programmer only needs to supply the correct analog pin designators in the ReadADx commands.</p><div class="informalfigure"><div class="mediaobject" align="center"><img src="./images/adcoverviewb3.PNG" align="middle" alt="graphic"></div></div><p>The 12-bit returned result is available on the ADRESH and ADRESL registers which is returned by the GCBASIC methods as an integer variable.</p><p>Some Microchip PIC microcontrollers have differential A/D modules and support differential Mode as well as 12-Bit A/D. With DIfferential mode the returned value can be either a positive or negative number that represents the voltage differential between the two A/D ports.</p><p>The syntax for differential A/D is ReadAD( PositiveANPort , NegativeANPort ).  Note: if "negative port" is omitted readAd() will perform a single-ended read on the positive AN port.</p><p>Example</p><pre class="screen">  Print ReadAD12( AN3, An4 )</pre><p><span class="strong"><strong>Using Voltage Reference</strong></span></p><p>Voltage references come in many forms and offer different features across the PICs, AVR and LGTs microcontrollers.&nbsp;&nbsp;
But, in the end, accuracy and stability are a voltage reference&#8217;s most important features, as the main purpose of the reference is to provide a known output voltage.&nbsp;&nbsp;
Variation from this known value is an error.&nbsp;&nbsp;
Therefore, it is useful to use the internal voltage reference provided within the microcontroller.</p><p>To use a voltage reference source for ADC operation sett the <code class="literal">AD_REF_SOURCE</code> constant to your chosen source.&nbsp;&nbsp;
The defaults to the VCC pin, and there for the constant is set by default to <code class="literal">AD_REF_AVCC</code>.&nbsp;&nbsp;
The voltage reference is specific to the microcontroller but the options are as follows:</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"></colgroup><thead><tr><th align="left" valign="top"><span class="strong"><strong>AD_REF_SOURCEConstant</strong></span></th><th align="left" valign="top"><span class="strong"><strong>Reference Voltage</strong></span></th></tr></thead><tbody><tr><td align="left" valign="top"><p>AD_REF_AVCC</p></td><td align="left" valign="top"><p>VCC supplied Voltage</p></td></tr><tr><td align="left" valign="top"><p>AD_REF_1024</p></td><td align="left" valign="top"><p>1.024v internal reference source</p></td></tr><tr><td align="left" valign="top"><p>AD_REF_2048</p></td><td align="left" valign="top"><p>2.048v internal reference source</p></td></tr><tr><td align="left" valign="top"><p>AD_REF_4096</p></td><td align="left" valign="top"><p>4.096v internal reference source</p></td></tr><tr><td align="left" valign="top"><p>AD_REF_AREF</p></td><td align="left" valign="top"><p>Extenal voltage reference source</p></td></tr><tr><td align="left" valign="top"><p>AD_REF_256</p></td><td align="left" valign="top"><p>AD_REF_256 for ATMegas</p></td></tr></tbody></table></div><p><span class="strong"><strong>Optimising GCBASIC Code</strong></span></p><p>GCBASIC supports a wide range of A/D modules and the supporting library addresses up to 34 channels.
To reduce the size of the code produced you can define which channels are specifically supported.  See <a class="link" href="_analog_digital_conversion_code_optimisation.html" title="Analog/Digital Conversion Code Optimisation">Optimising ADC code</a> for more details.</p><p>See also <a class="link" href="_readad.html" title="ReadAD">ReadAD</a>, <a class="link" href="_readad10.html" title="ReadAD10">ReadAD10</a> and <a class="link" href="_readad12.html" title="ReadAD12">ReadAD12</a></p><p>For the latest Microchip PIC microcontrollers that support Differential and 12-bit A/D please refer to Microchip MAPS or the microcontrollers datasheet.</p></div></body></html>