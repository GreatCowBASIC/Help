<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>InitTimer1</title><link rel="stylesheet" type="text/css" href="gcbdoc.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="GCBASIC documentation"><link rel="up" href="_timers.html" title="Timers"><link rel="prev" href="_inittimer0_8bit_16bit.html" title="InitTimer0 8bit/16bit"><link rel="next" href="_inittimer2.html" title="InitTimer2"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_inittimer1"></a>InitTimer1</h4></div></div></div><p><span class="strong"><strong>Syntax:</strong></span></p><pre class="screen">    InitTimer1 <span class="emphasis"><em>source, prescaler</em></span></pre><p><span class="strong"><strong>Command Availability:</strong></span></p><p>Available on all microcontrollers with a Timer 1 module.</p><p><span class="strong"><strong>Explanation:</strong></span></p><p><code class="literal">InitTimer1</code> will set up timer 1.</p><p>Parameters are required as detailed in the table below:</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"></colgroup><thead><tr><th align="left" valign="top">Parameter</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal"><span class="emphasis"><em>source</em></span></code></p></td><td align="left" valign="top"><p>The clock source for this specific timer. Can be either <code class="literal">Osc</code>, <code class="literal">Ext</code> or <code class="literal">ExtOsc</code> where:<br>
<code class="literal">Osc</code> is an internal oscillator.<br>
<code class="literal">Ext</code> is an external oscillator.<br>
<br>
<br>
<code class="literal">Osc</code> - Selects the clock source in use, as set by the microcontroller specific configuration (fuses or #config).&nbsp;&nbsp;This could be an internal clock or an external clock source ( external clock sources are typically attached to the XTAL pins).
</p><p><code class="literal">Ext</code> - Selects the clock source attached to a specific exernal interrupt input port.&nbsp;&nbsp;This allows a different clock frequency than the main clock to be used, such as 32.768 kHz crystals commonly used for real time circuits.
<br>
<br>
</p><p><code class="literal">ExtOsc</code> is an external oscillator and only available on a Microchip PIC microcontroller.
</p><p></p><p></p><p>Enhanced Microchip PIC microcontrollers with a dedicated TMRxCLK register support additional clock sources.  This includes, but limited to,  the following devices: 16F153xx, 16F16xx, 16F188xx and 18FxxK40 Microchip PIC microcontroller  series.  On these devices the clock source can be one of the following:
</p><p><code class="literal">Osc</code> is an internal oscillator which is the same source as <code class="literal">FOSC4</code>.<br>
<code class="literal">Ext</code>  is an external oscillator which is the same source as <code class="literal">TxXKIPPS</code>.<br>
<code class="literal">ExtOsc</code> is an external oscillator which is the same source as <code class="literal">SOSC</code>.<br>
<code class="literal">FOSC</code> is an internal oscillator which is the Frequency of the OSCillator.<br>
<code class="literal">FOSC4</code> is an internal oscillator which is the Frequency of the OSCillator divided by 4.<br>
<code class="literal">SOSC</code> is an external oscillator which is the same source as <code class="literal">SOSC</code>.<br>
<code class="literal">MFINTOSC</code> is an internal 500KHz internal clock oscillator.<br>
<code class="literal">LFINTOSC</code>  is an internal 31Khz internal clock oscillator.<br>
<code class="literal">HFINTOSC</code> is an oscillator as specified within the datasheet for each specific microcontroller.<br>
<code class="literal">TxCKIPPS</code> is an oscillator input on TxCKIPPS Pin.<br></p></td></tr><tr><td align="left" valign="top"><p><code class="literal"><span class="emphasis"><em>prescaler</em></span></code></p></td><td align="left" valign="top"><p>The value of the prescaler for this specific timer.  See the tables below for permitted vales for Microchip PIC or the Atmel AVR microcontrollers.</p></td></tr></tbody></table></div><p>When the timer overflows an interrupt event will be generated.
This interrupt event can be used in conjunction with <code class="literal">On Interrupt</code> to run a section of code when the interrupt event occurs.
<br>
<br>
<br>
<br>
<span class="strong"><strong>Microchip PIC microcontrollers:</strong></span></p><p>On Microchip PIC microcontrollers <code class="literal"><span class="emphasis"><em>prescaler</em></span></code> must be one of the following constants:</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="center" valign="top"><span class="strong"><strong>Prescaler Value</strong></span></th><th align="left" valign="top"><span class="strong"><strong>Primary GCB Constant</strong></span></th><th align="center" valign="top"><span class="strong"><strong>Constant Equates<br>
to value</strong></span></th></tr></thead><tbody><tr><td align="center" valign="top"><p>1:1</p></td><td align="left" valign="top"><p><code class="literal">PS1_1</code></p></td><td align="center" valign="top"><p>0</p></td></tr><tr><td align="center" valign="top"><p>1:2</p></td><td align="left" valign="top"><p><code class="literal">PS1_2</code></p></td><td align="center" valign="top"><p>16</p></td></tr><tr><td align="center" valign="top"><p>1:4</p></td><td align="left" valign="top"><p><code class="literal">PS1_4</code></p></td><td align="center" valign="top"><p>32</p></td></tr><tr><td align="center" valign="top"><p>1:8</p></td><td align="left" valign="top"><p><code class="literal">PS1_8</code></p></td><td align="center" valign="top"><p>48</p></td></tr></tbody></table></div><p>These correspond to a prescaler of between 1:2 and 1:8 of the oscillator (FOSC/4)
speed. The prescaler will apply to either the oscillator or the external
clock input.
<br>
<br>
<br>
<br>
<span class="strong"><strong>Atmel AVR microcontrollers:</strong></span></p><p>On the majority of Atmel AVR microcontrollers  <code class="literal"><span class="emphasis"><em>prescaler</em></span></code> must be one of the following constants:</p><p>The prescaler will only apply when the timer is driven from the <code class="literal">Osc</code> the internal oscillator - the prescaler has no effect when the external clock source is specified.</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"><col class="col_4"></colgroup><thead><tr><th align="center" valign="top"><span class="strong"><strong>Prescaler Value</strong></span></th><th align="left" valign="top"><span class="strong"><strong>Primary GCB Constant</strong></span></th><th align="left" valign="top"><span class="strong"><strong>Secondary GCB Constant</strong></span></th><th align="center" valign="top"><span class="strong"><strong>Constant Equates<br>
to value</strong></span></th></tr></thead><tbody><tr><td align="center" valign="top"><p>1:0</p></td><td align="left" valign="top"><p><code class="literal">PS_0</code></p></td><td align="left" valign="top"><p><code class="literal">PS_1_0</code></p></td><td align="center" valign="top"><p>0</p></td></tr><tr><td align="center" valign="top"><p>1:1</p></td><td align="left" valign="top"><p><code class="literal">PS_1</code></p></td><td align="left" valign="top"><p><code class="literal">PS_1_1</code></p></td><td align="center" valign="top"><p>1</p></td></tr><tr><td align="center" valign="top"><p>1:8</p></td><td align="left" valign="top"><p><code class="literal">PS_8</code></p></td><td align="left" valign="top"><p><code class="literal">PS_1_8</code></p></td><td align="center" valign="top"><p>2</p></td></tr><tr><td align="center" valign="top"><p>1:64</p></td><td align="left" valign="top"><p><code class="literal">PS_64</code></p></td><td align="left" valign="top"><p><code class="literal">PS_1_64</code></p></td><td align="center" valign="top"><p>3</p></td></tr><tr><td align="center" valign="top"><p>1:256</p></td><td align="left" valign="top"><p><code class="literal">PS_256</code></p></td><td align="left" valign="top"><p><code class="literal">PS1_256</code></p></td><td align="center" valign="top"><p>4</p></td></tr><tr><td align="center" valign="top"><p>1:1024</p></td><td align="left" valign="top"><p><code class="literal">PS_1024</code></p></td><td align="left" valign="top"><p><code class="literal">PS_1_1024</code></p></td><td align="center" valign="top"><p>5</p></td></tr></tbody></table></div><p><br>
<br>
<br></p><p>On Atmel AVR ATtiny15/25/45/85/216/461/861 microcontrollers <code class="literal"><span class="emphasis"><em>prescaler</em></span></code> must be one of the following constants:</p><p>The prescaler will only apply when the timer is driven from the <code class="literal">Osc</code> the internal oscillator - the prescaler has no effect when the external clock source is specified.</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="center" valign="top"><span class="strong"><strong>Prescaler Value</strong></span></th><th align="left" valign="top"><span class="strong"><strong>Primary GCB Constant</strong></span></th><th align="center" valign="top"><span class="strong"><strong>Constant Equates<br>
to value</strong></span></th></tr></thead><tbody><tr><td align="center" valign="top"><p>1:0</p></td><td align="left" valign="top"><p><code class="literal">PS_1_0</code></p></td><td align="center" valign="top"><p>0</p></td></tr><tr><td align="center" valign="top"><p>1:1</p></td><td align="left" valign="top"><p><code class="literal">PS_1_1</code></p></td><td align="center" valign="top"><p>1</p></td></tr><tr><td align="center" valign="top"><p>1:2</p></td><td align="left" valign="top"><p><code class="literal">PS_1_2</code></p></td><td align="center" valign="top"><p>2</p></td></tr><tr><td align="center" valign="top"><p>1:4</p></td><td align="left" valign="top"><p><code class="literal">PS_1_4</code></p></td><td align="center" valign="top"><p>3</p></td></tr><tr><td align="center" valign="top"><p>1:8</p></td><td align="left" valign="top"><p><code class="literal">PS_1_8</code></p></td><td align="center" valign="top"><p>4</p></td></tr><tr><td align="center" valign="top"><p>1:16</p></td><td align="left" valign="top"><p><code class="literal">PS_1_16</code></p></td><td align="center" valign="top"><p>5</p></td></tr><tr><td align="center" valign="top"><p>1:32</p></td><td align="left" valign="top"><p><code class="literal">PS_1_32</code></p></td><td align="center" valign="top"><p>6</p></td></tr><tr><td align="center" valign="top"><p>1:64</p></td><td align="left" valign="top"><p><code class="literal">PS_1_64</code></p></td><td align="center" valign="top"><p>7</p></td></tr><tr><td align="center" valign="top"><p>1:128</p></td><td align="left" valign="top"><p><code class="literal">PS_1_128</code></p></td><td align="center" valign="top"><p>8</p></td></tr><tr><td align="center" valign="top"><p>1:256</p></td><td align="left" valign="top"><p><code class="literal">PS_1_256</code></p></td><td align="center" valign="top"><p>9</p></td></tr><tr><td align="center" valign="top"><p>1:512</p></td><td align="left" valign="top"><p><code class="literal">PS_1_512</code></p></td><td align="center" valign="top"><p>10</p></td></tr><tr><td align="center" valign="top"><p>1:1024</p></td><td align="left" valign="top"><p><code class="literal">PS_1_1024</code></p></td><td align="center" valign="top"><p>11</p></td></tr><tr><td align="center" valign="top"><p>1:2048</p></td><td align="left" valign="top"><p><code class="literal">PS_1_2048</code></p></td><td align="center" valign="top"><p>12</p></td></tr><tr><td align="center" valign="top"><p>1:4096</p></td><td align="left" valign="top"><p><code class="literal">PS_1_4096</code></p></td><td align="center" valign="top"><p>13</p></td></tr><tr><td align="center" valign="top"><p>1:8192</p></td><td align="left" valign="top"><p><code class="literal">PS_1_8192</code></p></td><td align="center" valign="top"><p>14</p></td></tr><tr><td align="center" valign="top"><p>1:16384</p></td><td align="left" valign="top"><p><code class="literal">PS_1_16384</code></p></td><td align="center" valign="top"><p>15</p></td></tr></tbody></table></div><p><br>
<br>
<span class="strong"><strong>Example 1 (Microchip):</strong></span></p><p>This example will measure that time that a switch is depressed (or on) and will write the results to the EEPROM.</p><pre class="screen">    #chip 16F819, 20
    #define Switch PORTA.0

    Dir Switch In
    DataCount = 0

    'Initilise Timer 1
    InitTimer1 Osc, PS1_8

    Dim TimerValue As Word

    Do
        ClearTimer 1
        Wait Until Switch = On
        StartTimer 1
        Wait Until Switch = Off
        StopTimer 1

        'Read the timer
        TimerValue = Timer1

        'Log the timer value
        EPWrite(DataCount, TimerValue_H)
        EPWrite(DataCount + 1, TimerValue)
        DataCount += 2
    Loop</pre><p><br>
<br>
<span class="strong"><strong>Example 2 (Atmel AVR):</strong></span></p><p>This example will flash the yellow LED on an Arduino Uno (R3) once every second.</p><pre class="literallayout">#Chip mega328p, 16  'Using Arduino Uno R3</pre><pre class="literallayout">#define LED PORTB.5
Dir LED OUT</pre><pre class="literallayout">Inittimer1  OSC, PS_256
Starttimer 1
Settimer 1, 3200  ;Preload Timer</pre><pre class="literallayout">On Interrupt Timer1Overflow Call Flash_LED</pre><pre class="literallayout">Do
    'Wait for interrupt
loop</pre><pre class="literallayout">Sub Flash_LED
   Settimer 1, 3200   'Preload timer
   pulseout LED, 100 ms
End Sub</pre><p><span class="strong"><strong>Supported in &lt;TIMER.H&gt;</strong></span></p></div></body></html>