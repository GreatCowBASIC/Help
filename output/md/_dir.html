<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Dir</title><link rel="stylesheet" type="text/css" href="gcbdoc.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="GCBASIC documentation"><link rel="up" href="_miscellaneous_commands.html" title="Miscellaneous Commands"><link rel="prev" href="_miscellaneous_commands.html" title="Miscellaneous Commands"><link rel="next" href="_getuserid.html" title="GetUserID"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_dir"></a>Dir</h4></div></div></div><p><span class="strong"><strong>Syntax:</strong></span></p><pre class="screen">    Dir <span class="emphasis"><em>port.bit</em></span> {In | Out}               <span class="strong"><strong><span class="emphasis"><em>(Individual Form)</em></span></strong></span>
    Dir <span class="emphasis"><em>port</em></span> {In | Out | <span class="emphasis"><em>DirectionByte</em></span>}  <span class="strong"><strong><span class="emphasis"><em>(Entire Port Form)</em></span></strong></span></pre><p><span class="strong"><strong>Command Availability:</strong></span></p><p>Available on all microcontrollers.</p><p><span class="strong"><strong>Explanation:</strong></span></p><p>The <code class="literal">Dir</code> command is used to set the direction of the ports of the microcontroller chip. The individual form sets the direction of one pin at a time, whereas the entire port form will set all bits in a port.</p><p>In the individual form, specify the port and bit (ie. <code class="literal">PORTB.4</code>), then the direction, which is either In or Out.</p><p>The entire port form is similiar to the <code class="literal">TRIS</code> instruction offered by some Microchip PIC microcontrollers. To use it, give the name of the port (<span class="emphasis"><em>i.e.</em></span> <code class="literal">PORTA</code>), and then a byte is to be written into the <code class="literal">TRIS</code> variable. This form of the command is for those who are familiar with the Microchip PIC microcontrollers internal architecture.</p><p><span class="strong"><strong>Note:</strong></span>
Entire port form will work differently on Atmel AVR microcontrollers when a value other than IN or OUT is used. Atmel AVR microcontrollers use 0 to indicate in and 1 to indicate out, whereas Microchip PIC microcontrollers use 0 for out and 1 for in. When IN and OUT are used there are no compatibility issues.</p><p><span class="strong"><strong>Example:</strong></span></p><pre class="screen">    'This program sets PORTA bits 0 and 1 to in, and the rest to out.
    'It also sets all of PORTB to output, except for B1.
    'Individual form is used for PORTA:
    DIR PORTA.0 IN
    DIR PORTA.1 IN
    DIR PORTA.2 OUT
    DIR PORTA.3 OUT
    DIR PORTA.4 OUT
    DIR PORTA.5 OUT
    DIR PORTA.6 OUT
    DIR PORTA.7 OUT
    'Entire port form used for B:
    DIR PORTB b'00000010'

    'Entire port form used for C:
    DIR PORTC IN</pre><p><span class="strong"><strong>Automatic DIRection setting by the compiler</strong></span></p><p>The compiler will set the automatic pin DIRection using the following logic.</p><p>Any time that the user program reads a pin or port, the compiler records that.   Any time that the user program writes to a pin or entire port, the compiler also records that.</p><p>Once all input code has been compiled, the compiler examinies the list of reads and writes.</p><p>If a pin is only ever written to, the compiler makes it an output.</p><p>If a pin is only ever read, the compiler does not know if the intent is to read the latch or an input value, so it sets that pin to be an input.</p><p>If the compiler sees a pin being read and written to, the compiler does not know if you are using a pin for some sort of bidirectional communication, or if you are just reading the latch. To avoid making incorrect assumptions, the compiler will expect you to set the pin direction manually.</p><p>If you use "portA.2 = 1", you&#8217;ve only written to the pin, so the compiler knows it must be an output.</p><p>If you use "portA.2 = not portA.2", the compiler sees that you are reading and writing to the pin, and will expect the user program set the direction instead of trying to guess what you are doing.</p><p>The compiler also records any use of the Dir command, and will not do any automatic direction setting on a pin if Dir has been used on that pin anywhere in the user program..</p></div></body></html>