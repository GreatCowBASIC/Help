<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Arrays</title><link rel="stylesheet" type="text/css" href="gcbdoc.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="GCBASIC documentation"><link rel="up" href="_syntax.html" title="Syntax"><link rel="prev" href="_syntax.html" title="Syntax"><link rel="next" href="_comments.html" title="Comments"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_arrays"></a>Arrays</h3></div></div></div><p><span class="strong"><strong>About Arrays</strong></span></p><p>An array is a special type of variable - one which can store several values at once.&nbsp;&nbsp;It is essentially a list of numbers in which each one can be addressed individually through the use of an "index".</p><p>The numbers can be bytes (the default), longs, integers, or words.  &nbsp;&nbsp;The index is a value in brackets immediately after the name of the array.</p><p>All the numbers stored in an array must be of the same type.  &nbsp;&nbsp;For instance, you cannot store bytes and words in the same array.</p><p>Array are are 1-based. &nbsp;&nbsp;The first element is element zero.</p><p>Examples of array names are:</p><div class="informaltable"><table border="1" width="80%"><colgroup><col class="col_1"><col class="col_2"></colgroup><thead><tr><th align="left" valign="top"><span class="strong"><strong>Array/Index</strong></span></th><th align="left" valign="top"><span class="strong"><strong>Meaning</strong></span></th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">Fish(10)</code></p></td><td align="left" valign="top"><p>Definition of an array containing bytes with 10 elements called <code class="literal">Fish</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">x(5) As Word</code></p></td><td align="left" valign="top"><p>Definition of an array containing words with 5 elements called <code class="literal">x</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">DataLog(2)</code></p></td><td align="left" valign="top"><p>The second element in an array named <code class="literal">DataLog</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ButtonList(Temp)</code></p></td><td align="left" valign="top"><p>An element in the array <code class="literal">ButtonList</code> that is selected according to the
value in the variable <code class="literal">Temp</code></p></td></tr></tbody></table></div><p><span class="strong"><strong>Defining an array</strong></span></p><p>Use the DIM command to define an array.</p><pre class="screen">    DIM array_title ( number_of_elements ) [As _type_]</pre><p>The number of elements can be number or a constant - not a variable.</p><p>The value for the number elements in an array must be a number or constant.
The compiler allocates RAM for arrays at compile time, and therefore you cannot use a variable because during compilation the value of a variable cannot be determined.</p><p><span class="strong"><strong>Assigning values to an array</strong></span></p><p>It is possible to set several elements of a byte array with a single line of code. This short example shows how:</p><pre class="screen">    Dim TestVar(10)
    TestVar = 1, 2, 3, 4, 5, 6, 7, 8, 9</pre><p>When using this method above element 0 of the array TestVar will be set to the number of items in the list, which in this case is 9. &nbsp;&nbsp;Each element of the array will then be loaded with the corresponding value in the list - so in the example, TestVar(1) will be set to 1, TestVar(2) to 2, and so on.  &nbsp;&nbsp;Element 0 will only be set to number of items in the array when using this method.   &nbsp;&nbsp;For microcontrollers with less than 2048 bytes of RAM the limit is 250 elements or the array cannot exceed the microcontrollers RAM size.  &nbsp;&nbsp;For microcontrollers with more than 2048 bytes of RAM the limit is 255 elements.</p><p>This only works for <span class="strong"><strong>byte</strong></span> arrays, however.  For arrays of type <code class="literal">integer</code>, <code class="literal">word</code>, or <code class="literal">long</code>, each element must be set separately:</p><pre class="screen">    Dim TestVar(5) As Word
    TestVar(1) = 20
    TestVar(2) = 50
    TestVar(3) = 60
    TestVar(4) = 80
    TestVar(5) = 100</pre><p>If each element has the same value, this can be shortened using a loop:</p><pre class="screen">    Dim TestVar(5) As Word
    For i = 1 to 5
        TestVar(i) = 0
    Next</pre><p><span class="strong"><strong>Array Length</strong></span></p><p>Element 0 should not be used to obtain the length of the array.&nbsp;&nbsp; Element 0 will only be a consistent with respect to the length of the array when the array is set as shown above.</p><p>The correct method is to use a constant to set the array size and use the constant within your code to obtain the array length.</p><pre class="screen">    #Define ArraySizeConstant 500
    Dim TestVar( ArraySizeConstant )

    SerPrint ArraySizeConstant     'or, other usage</pre><p><span class="strong"><strong>Using Arrays</strong></span></p><p>To use an array, its name is specified, then the index. Arrays can be used everywhere that a normal variable can be used.</p><p><span class="strong"><strong>Maximum Array Size</strong></span></p><p>The limit on the array size is dependent on the chip type, the amount of RAM, and the number of other variable you use in your program.</p><p>Use the following simple program to determine the maximum array size. Set <code class="literal">CHIP</code> to your device, <code class="literal">MAXSCOPE</code> to a value which is less the total RAM, and the data type of <code class="literal">test_array</code> to the data type to be stored in the array.</p><p>The data type of <code class="literal">imaxscope</code> must be set to match the size of the constant <code class="literal">MAXSCOPE</code>.  If <code class="literal">MAXSCOPE</code> &#8656; 255, <code class="literal">imaxscope</code> should be a byte.&nbsp;&nbsp;  If <code class="literal">MAXSCOPE</code> &gt; 255, <code class="literal">imaxscope</code> should be a word.</p><p>If the array is too large to fit, the compiler will issue an error message.  &nbsp;&nbsp;Reduce MAXSCOPE until the error message is not issued.  &nbsp;&nbsp;The largest <code class="literal">MAXSCOPE</code> value without an error message is the largest useable array of this type for this chip.</p><pre class="screen">    #CHIP   12f1571
    #OPTION Explicit

    #DEFINE MAXSCOPE  111
    DIM     imaxscope As Byte
    DIM     test_array( MAXSCOPE ) As Byte


    For imaxscope = 0 to MAXSCOPE
      test_array( imaxscope ) = imaxscope
    Next</pre><p>For the Atmel AVR, LGT 328p or an 18F array sizes are limited to 10,000 elements.</p><p>If a memory limit is reached, the compiler will issue an error message.</p><p><span class="strong"><strong>Get the most from the available memory</strong></span></p><p>Array RAM usage is determined by the architecture of the chip type. &nbsp;&nbsp;Getting most out of the available memory is determined by the allocation of the array within the available banks of memory.</p><p>An example is an array of 6 or 7 bytes when there is only 24 bytes of RAM  and the 24 bytes is split across multiple memory banks.  &nbsp;&nbsp;Assume in this example that 18 bytes have allocated to other variables and there is 29 bytes total available.  &nbsp;&nbsp;An array of 6 bytes will fit into the free space in one bank, but the array of 7 will not.</p><p>GCBASIC currently cannot split an array over banks, so if there are 6 bytes free in one bank and 5 in another, you cannot have an array of 7 bytes. &nbsp;&nbsp; This would be very hard to do efficiently on 12F/16F as there would be a series of special function registers in the middle of the array when using a 12F or 16F.   &nbsp;&nbsp;This constraint is not the case on 16F1/18F as linear addressing makes it easy to span banks because the SFRs are not making the problem (as with 12F/16F).</p><p><span class="strong"><strong>Using Tables as an alternative.</strong></span></p><p>If there are many items in the array, it may be better to use a Lookup Table to store the items, and then copy some of the data items into a smaller array as needed.</p><p><span class="strong"><strong>For more help, see</strong></span> <a class="link" href="_dim.html" title="Dim">Declaring arrays with DIM</a>,<a class="link" href="_alloc.html" title="Alloc">Declaring memory with ALLOC</a></p></div></body></html>