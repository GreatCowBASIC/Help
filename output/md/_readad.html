<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>ReadAD</title><link rel="stylesheet" type="text/css" href="gcbdoc.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="GCBASIC documentation"><link rel="up" href="_analog_digital_conversion.html" title="Analog/Digital conversion"><link rel="prev" href="_adoff.html" title="ADOff"><link rel="next" href="_readad10.html" title="ReadAD10"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_readad"></a>ReadAD</h4></div></div></div><p><span class="strong"><strong>Syntax:</strong></span></p><p>For a normal ( also called a Single Channel )  read use.</p><pre class="screen">    byte_variable = ReadAD( ANX )</pre><p>For a Differential Channel read use the following.&nbsp;&nbsp;Where ANpX is the positive port, and ANnY is the negative port.</p><pre class="screen">    byte_variable = ReadAD( ANpX , ANnY )</pre><p>To obtain a byte value from an AD Channel use the following to force an 8 bit AD Channel to respond with a byte value [0 to 255].</p><pre class="screen">    byte_variable = ReadAD( ANX , TRUE )</pre><p><span class="strong"><strong>Command Availability:</strong></span></p><p>When using <span class="strong"><strong>ReadAD</strong></span> ( ANx ) the returned value is an 8 bit number [0- 255].&nbsp;&nbsp;The byte variable assigned by the function can be a byte, word, integer or long.</p><p>When using <span class="strong"><strong>ReadAD</strong></span> ( ANpX , ANnY ) the returned value is an integer, as negative values can be returned.</p><p>When using <span class="strong"><strong>ReadAD</strong></span> ( ANpX , TRUE ) the returned value is an integer, but you should treat as a byte.</p><p>ReadAD is a function that can be used to read the built-in analog to digital converter that many microcontroller chips include.&nbsp;&nbsp;port should be specified as AN0, AN1, AN2, etc., up to the number of analog inputs available on the chip that is in use.&nbsp;&nbsp;Those familiar with Atmel AVR microcontrollers can also refer to the ports as ADC0, ADC1, etc.&nbsp;&nbsp;Refer to the datasheet for the microcontroller chip to find the number of ports available.&nbsp;&nbsp;(Note: it&#8217;s perfectly acceptable to use ANx on AVR, or ADCx on the microcontroller)</p><p>Other functions that are similar are <span class="strong"><strong>ReadAD10</strong></span> and <span class="strong"><strong>ReadAD12</strong></span>.&nbsp;&nbsp;See the relevant Help page for the specific usage of each function.</p><p>The constant <span class="strong"><strong>AD_Delay</strong></span> controls is the acquisition delay.&nbsp;&nbsp;The default value is 20 us.&nbsp;&nbsp;This can be changed by adding the following constant.</p><pre class="screen">    #define AD_Delay 2 10us</pre><p><span class="strong"><strong>ADSpeed</strong></span> controls the source of the clock for the ADC module.&nbsp;&nbsp; It varies from one chip to another.&nbsp;&nbsp; InternalClock is a Microchip PIC microcontroller only option that will drive the ADC from an internal RC oscillator.&nbsp;&nbsp;The default value is 128.</p><p>Using ADSPEED</p><pre class="screen">    'default value
    #define ADSpeed MediumSpeed


    'pre-defined constants
    #define HighSpeed 255
    #define MediumSpeed 128
    #define LowSpeed 0</pre><p><span class="strong"><strong>AD_VREF_DELAY</strong></span> controls the charging time for VRef capacitor on Atmel AVR microcontrollers only.&nbsp;&nbsp;This therefore controls the charge from internal VRef.&nbsp;&nbsp; ReadAD will not be accurate for internal reference without this.</p><p><span class="strong"><strong>AD_Acquisition_Time_Select_bits</strong></span> also controls the Acquisition Time Select bits.&nbsp;&nbsp; Acquisition time is the duration that the AD charge
holding capacitor remains connected to AD channel from the instant the read is commenced is set until conversions begins.</p><p>The default value of AD_Acquisition_Time_Select_bits is 0b100 or decimal 4, where all three ACQT bits will be set.&nbsp;&nbsp;To change use the following.</p><pre class="screen">    'change the default value
    #define AD_Acquisition_Time_Select_bits 0b001    'this will only set ACQT bit 0, ACQT bits 1 and 2 will be cleared.</pre><p><span class="strong"><strong>Example 1</strong></span></p><p>This example reads the ADC port and writes the output to the EEPROM.</p><pre class="screen">    #chip 16F819, 8

    'Set the input pin direction
    Dir PORTA.0 In

    'Loop to take readings until the EEPROM is full
    For CurrentAddress = 0 to 255

        'Take a reading and log it
        EPWrite CurrentAddress, ReadAD(AN0)

        'Wait 10 minutes before getting another reading
        Wait 10 min
    Next</pre><p><span class="strong"><strong>Example 2</strong></span></p><p>This example reads the ADC port and writes the output to the EEPROM.&nbsp;&nbsp;The output value will be in the range of [0-255].</p><pre class="screen">    #chip 16F1789, 8


    'Set the input pin direction
    Dir PORTA.0 In

    'Loop to take readings until the EEPROM is full
    For CurrentAddress = 0 to 255

        'Take a reading and log it
        EPWrite CurrentAddress, ReadAD(AN0, TRUE)

        'Wait 10 minutes before getting another reading
        Wait 10 min
    Next</pre><p><span class="strong"><strong>Example 3</strong></span></p><p>This example used the diffential capabilities of ADC port and writes the output to the EEPROM.&nbsp;&nbsp;The output value will be in the range of [-255 to 255].</p><p>AN0 and AN2 are used for the diffential ADC reading.</p><pre class="screen">    #chip 16F1789, 8


    'Set the input pin direction
    Dir PORTA.0 In
    Dir PORTA.2 In

    'Loop to take readings until the EEPROM is full
    For CurrentAddress = 0 to 255

        'Take a reading and log it
        EPWrite CurrentAddress, ReadAD( AN0, AN2 )

        'Wait 10 minutes before getting another reading
        Wait 10 min
    Next</pre><p><span class="strong"><strong>See Also</strong></span> <a class="link" href="_readad10.html" title="ReadAD10">ReadAD10</a>, <a class="link" href="_readad12.html" title="ReadAD12">ReadAD12</a></p></div></body></html>