<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>ADS 7843 Serial Driver</title><link rel="stylesheet" type="text/css" href="gcbdoc.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="GCBASIC documentation"><link rel="up" href="_touch_screen.html" title="Touch Screen"><link rel="prev" href="_touch_screen.html" title="Touch Screen"><link rel="next" href="_liquid_crystal_display.html" title="Liquid Crystal Display"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_ads_7843_serial_driver"></a>ADS 7843 Serial Driver</h4></div></div></div><p><span class="strong"><strong>Syntax:</strong></span></p><pre class="screen">    ADS7843_Init

    ADS7843_GetXY

    ADS7843_SetPrecision</pre><p><span class="strong"><strong>Command Availability:</strong></span></p><p>Available on all microcontrollers. Requires the inclusion of the following:</p><pre class="screen">    #include &lt;ADS7843.h&gt;</pre><p><span class="strong"><strong>Explanation:</strong></span></p><p>The ADS7843 device is a 12-bit sampling Analog-to-Digital Converter (ADC) with a synchronous serial interface and low on resistance switches for driving touch screens.</p><p>The GCBASIC driver is integrated with the SDD1289 GLCD driver.  To use the ADS7843 driver the following is required to added to the GCBASIC source file.</p><p><code class="literal">ADS7843_Init</code> is required to initialise the touch screen. This is mandated.</p><p><code class="literal">ADS7843_GetXY</code> this sub-routine returns the X and Y coordinates of touched point.</p><p><code class="literal">ADS7843_SetPrecision</code> this sub-routine sets the level of precision of the touch screen.</p><p><span class="strong"><strong>Required Constants:</strong></span></p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="left" valign="top"><span class="strong"><strong>Constants</strong></span></th><th align="left" valign="top"><span class="strong"><strong>Controls/Direction</strong></span></th><th align="left" valign="top"><span class="strong"><strong>Default Value</strong></span></th></tr></thead><tbody><tr><td align="left" valign="top"><p>ADS7843_DOUT (IN)</p></td><td align="left" valign="top"><p>The chip output pin</p></td><td align="left" valign="top"><p>Mandated</p></td></tr><tr><td align="left" valign="top"><p>ADS7843_IRQ (IN)</p></td><td align="left" valign="top"><p>The interrupt pin</p></td><td align="left" valign="top"><p>Mandated</p></td></tr><tr><td align="left" valign="top"><p>ADS7843_CS (OUT)</p></td><td align="left" valign="top"><p>The chip select pin</p></td><td align="left" valign="top"><p>Mandated</p></td></tr><tr><td align="left" valign="top"><p>ADS7843_CLK (OUT)</p></td><td align="left" valign="top"><p>The clock pin</p></td><td align="left" valign="top"><p>Mandated</p></td></tr><tr><td align="left" valign="top"><p>ADS7843_DIN (OUT)</p></td><td align="left" valign="top"><p>The chip input pin</p></td><td align="left" valign="top"><p>Mandated</p></td></tr></tbody></table></div><p>The GCBASIC commands supported for this chip are:</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="left" valign="top"><span class="strong"><strong>Command</strong></span></th><th align="left" valign="top"><span class="strong"><strong>Purpose</strong></span></th><th align="left" valign="top"><span class="strong"><strong>Example</strong></span></th></tr></thead><tbody><tr><td align="left" valign="top"><p>ADS7843_Init</p></td><td align="left" valign="top"><p>Initialise the device.</p></td><td align="left" valign="top"><p>ADS7843_Init [Optional precision = PREC_EXTREME]</p></td></tr><tr><td align="left" valign="top"><p>ADS7843_GetXY</p></td><td align="left" valign="top"><p>Returns the X and Y coordinates of touched point.</p></td><td align="left" valign="top"><p>ADS7843_GetXY (TP_X, TP_Y )</p></td></tr><tr><td align="left" valign="top"><p>ADS7843_SetPrecision</p></td><td align="left" valign="top"><p>Set the precision of the conversion result.</p></td><td align="left" valign="top"><p>ADS7843_SetPrecision(precision)<br>
(with PREC_EXTREME the conversion error is less than 3%)</p></td></tr></tbody></table></div><p>Precision can be set to four values as shown in the table below.
Passing a parameter of ADS7843_SetPrecision changes the precision controls.</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="left" valign="top"><span class="strong"><strong>Constants</strong></span></th><th align="left" valign="top"><span class="strong"><strong>Defined  Value</strong></span></th><th align="left" valign="top"><span class="strong"><strong>Default Value</strong></span></th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">#define PREC_LOW</code></p></td><td align="left" valign="top"><p><code class="literal">1</code></p></td><td align="left" valign="top">&nbsp;</td></tr><tr><td align="left" valign="top"><p><code class="literal">#define PREC_MEDIUM</code></p></td><td align="left" valign="top"><p><code class="literal">2</code></p></td><td align="left" valign="top">&nbsp;</td></tr><tr><td align="left" valign="top"><p><code class="literal">#define PREC_HI</code></p></td><td align="left" valign="top"><p><code class="literal">3</code></p></td><td align="left" valign="top">&nbsp;</td></tr><tr><td align="left" valign="top"><p><code class="literal">#define  PREC_EXTREME</code></p></td><td align="left" valign="top"><p><code class="literal">4</code></p></td><td align="left" valign="top"><p>Default Value</p></td></tr></tbody></table></div><p><span class="strong"><strong>Example:</strong></span></p><p>For more information see <a class="link" href="http://www.ti.com/product/ads7843" target="_top">http://www.ti.com/product/ads7843</a>.</p><p>This example shows how to drive a SDD1289 based Graphic LCD module with ADS7843 touch controller.</p><pre class="screen">    'Chip Settings
    #chip mega2560, 16

    'Include for GLCD
    #include &lt;glcd.h&gt;

    'Include for ADS7843
    #include  &lt;ADS7843.h&gt;

    'GLCD Device Selection
    #DEFINE GLCD_TYPE GLCD_TYPE_SSD1289
    'Define ports for the SSD1289 display - ALL are required
    #DEFINE GLCD_WR   PORTG.2
    #DEFINE GLCD_CS   PORTG.1
    #DEFINE GLCD_RS   PORTD.7
    #DEFINE GLCD_RST  PORTG.0

    #DEFINE GLCD_DB0  PORTC.0
    #DEFINE GLCD_DB1  PORTC.1
    #DEFINE GLCD_DB2  PORTC.2
    #DEFINE GLCD_DB3  PORTC.3
    #DEFINE GLCD_DB4  PORTC.4
    #DEFINE GLCD_DB5  PORTC.5
    #DEFINE GLCD_DB6  PORTC.6
    #DEFINE GLCD_DB7  PORTC.7
    #DEFINE GLCD_DB8  PORTA.0
    #DEFINE GLCD_DB9  PORTA.1
    #DEFINE GLCD_DB10 PORTA.2
    #DEFINE GLCD_DB11 PORTA.3
    #DEFINE GLCD_DB12 PORTA.4
    #DEFINE GLCD_DB13 PORTA.5
    #DEFINE GLCD_DB14 PORTA.6
    #DEFINE GLCD_DB15 PORTA.7

    'GLCD font control
    #DEFINE GLCD_EXTENDEDFONTSET1

    'Define ports for ADS7843
    #define ADS7843_DOUT   PORTE.5  ' Arduino Mega D3
    #define ADS7843_IRQ    PORTE.4  ' Arduino Mega D2
    #define ADS7843_CS     PORTE.3  ' Arduino Mega D5
    #define ADS7843_CLK    PORTH.3  ' Arduino Mega D6
    #define ADS7843_DIN    PORTG.5  ' Arduino Mega D4
    #define ADS7843_BUSY   PORTH.4  ' Arduino Mega D7

    Wait 100 ms
    num=0
    Do Forever

      'Library function
      if ADS7843_IRQ=0 then

         num++
         GLCDPrint  10, 15,  str(num),SSD1289_YELLOW, 2

         'Libary sub routine - returns two variables
         ADS7843_GetXY ( TP_X , TP_Y )

         if TP_X&gt;=100 then GLCDPrint  100, 50, Str(TP_X),SSD1289_YELLOW, 2
         if TP_X&gt;=10 and TP_X&lt;100 then GLCDPrint  100, 50, Str(TP_X)+" ",SSD1289_YELLOW, 2
         if TP_X&lt;10 then GLCDPrint  100, 50,  Str(TP_X)+" ",SSD1289_YELLOW, 2
         if TP_Y&gt;=100 then GLCDPrint  100, 70, Str(TP_Y),SSD1289_YELLOW, 2
         if TP_Y&gt;=10 and TP_Y&lt;100 then GLCDPrint  100, 70, Str(TP_Y)+" ", SSD1289_YELLOW, 2
         if TP_Y&lt;10 then GLCDPrint  100, 70,  Str(TP_Y)+" ",SSD1289_YELLOW, 2

         'Set the pixel to yellow using the GLCD PSET sub routine
         Pset TP_X,  TP_Y, SSD1289_YELLOW

      end if
      Wait 1 ms

    Loop</pre></div></body></html>