<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Implementing a method with a Pin name as a parameter</title><link rel="stylesheet" type="text/css" href="gcbdoc.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="GCBASIC documentation"><link rel="up" href="_example_macros.html" title="Example Macros"><link rel="prev" href="_measuring_a_pulse_width.html" title="Measuring a Pulse Width"><link rel="next" href="_example_programs.html" title="Example Programs"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_implementing_a_method_with_a_pin_name_as_a_parameter"></a>Implementing a method with a Pin name as a parameter</h4></div></div></div><p><span class="strong"><strong>Introduction</strong></span></p><p>A constant such as a Pin name cannot be passed to a sub routine or a function.  This is a constraint of GCBASIC.</p><p>A macro can be used to implement a method of passing a constant to reusable code section.</p><p>The example shown below implements a button press routine and takes an input port constant and prints the result on an LCD display.</p><p><span class="strong"><strong>Note:</strong></span>
A macro will use more program memory as the macro will be compiled as inline code. Therefore, for every use of the macro will use additional program memory - the same amount of program memory for each call to the macro.</p><p><span class="strong"><strong>Demonstration Program:</strong></span></p><pre class="screen">    #chip 16F877a, 16
    #define Button PORTC.1    ' Switch on PIN 14 via 10K pullup resistor
    DIR Button In
    wait 1 sec

    'USART settings
    #define USART_BAUD_RATE 9600
    #define USART_TX_BLOCKING

    ;======== MAIN PROGRAM LOOP ================
    HSerPrint "Button Test"
    HSerPrintCRLF 2
    Do
       Test_button ( button )
    Loop
    ;==========================================

    Macro Test_button (Button)
       if Button = ON then
          wait 10 ms          'debounce
          ButtonCount = 0


           Do While Button = On
               Wait 10 ms
               ButtonCount += 1
           Loop


           if ButtonCount &gt; 5  then
               if ButtonCount &gt; 50 then   'Long push
                   hserprint "Long push"
               else                       'Short push
                   hserprint "Short push"
               end if
               HSerPrintCRLF
           end if
           wait 1 s
       end if
    End Macro</pre><p>Also see <a class="link" href="_macros_overview.html" title="Macros Overview">Macros Overview</a></p></div></body></html>