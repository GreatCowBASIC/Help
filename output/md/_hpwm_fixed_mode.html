<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>HPWM Fixed Mode</title><link rel="stylesheet" type="text/css" href="gcbdoc.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="GCBASIC documentation"><link rel="up" href="_microchip_pic_pwm_overview.html" title="Microchip PIC PWM Overview"><link rel="prev" href="_hpwm_16_bit.html" title="HPWM 16 Bit"><link rel="next" href="_pwmon.html" title="PWMOn"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="_hpwm_fixed_mode"></a>HPWM Fixed Mode</h5></div></div></div><p><span class="strong"><strong>Syntax:</strong></span></p><pre class="screen">    PWMOn               'only applies to CCP/PWM channel 1
    'or
    PWMOff

    PWMOn( channel )            'where the parameter can be any valid CCP/PWM channel, 1, 2, 3, 4 or 5
    'or
    PWMOff( channel )

    PWMOn( module_number , <code class="literal">PWMModule</code>)            'where the parameter can be any valid PWM channel 1 .. 9
    'or
    PWMOff( module_number , <code class="literal">PWMModule</code>)</pre><p><span class="strong"><strong>Command Availability:</strong></span></p><p><span class="strong"><strong>Only</strong></span> available on Microchip PIC microcontrollers with a CCP/PWM or PWM module.</p><p>See here <a class="link" href="_hpwm_ccp.html" title="HPWM CCP">HPWM CCP</a> for the method to change PWM parameters dynamically or to use other CCP channels - this method support  CCP1/PWM, CCP2/PWM, CCP3/PWM, CCP4/PWM and CCP5/PWM.</p><p><span class="strong"><strong>Explanation:</strong></span></p><p>This command sets up the hardware PWM module of the Microchip PIC microcontroller to generate
a PWM waveform of the given frequency and duty cycle. &nbsp;&nbsp;Once this command
is called, the PWM will be emitted until PWMOff is called.</p><p>These constants are required to set the parameters for the PWM.  The frequency and the duty applies to all channels when using the method(s) or macro(s) shown above.</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="left" valign="top"><span class="strong"><strong>Constant Name</strong></span></th><th align="left" valign="top"><span class="strong"><strong>Controls</strong></span></th><th align="left" valign="top"><span class="strong"><strong>Default Value</strong></span></th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">PWM_Freq</code></p></td><td align="left" valign="top"><p>Specifies the output frequency of the PWM module in KHz.</p></td><td align="left" valign="top"><p>38</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">PWM_Duty</code></p></td><td align="left" valign="top"><p>Sets the duty cycle of the PWM module output. Given as percentage.</p></td><td align="left" valign="top"><p>50</p></td></tr></tbody></table></div><p><br>
For CCP/PWM modules are also supported using a call to a method or a macro, as follows:
<br></p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="left" valign="top"><span class="strong"><strong>Method/Macro</strong></span></th><th align="left" valign="top"><span class="strong"><strong>Controls</strong></span></th><th align="left" valign="top"><span class="strong"><strong>Default Value</strong></span></th></tr></thead><tbody><tr><td align="left" valign="top"><p>PWMOn</p></td><td align="left" valign="top"><p>No parameter enables CCP1/PWM only</p></td><td align="left" valign="top"><p>No parameter</p></td></tr><tr><td align="left" valign="top"><p>PWMOff</p></td><td align="left" valign="top"><p>Disables CCP1/PWM only</p></td><td align="left" valign="top">&nbsp;</td></tr><tr><td align="left" valign="top"><p>PWMOn( <code class="literal">channel</code> )</p></td><td align="left" valign="top"><p>Where the parameter is any valid CCP/PWM channel</p></td><td align="left" valign="top"><p><code class="literal">channel</code> can be 1, 2, 3, 4 or 5</p></td></tr><tr><td align="left" valign="top"><p>PWMOff( <code class="literal">channel</code> )</p></td><td align="left" valign="top"><p>Where the parameter is any valid CCP/PWM channel</p></td><td align="left" valign="top"><p><code class="literal">channel</code> can be 1, 2, 3, 4 or 5</p></td></tr><tr><td align="left" valign="top"><p>PWMOn( <code class="literal">module</code>, PWMMODULE )</p></td><td align="left" valign="top"><p>Where the parameter is any valid PWM module</p></td><td align="left" valign="top"><p><code class="literal">module</code> can be 1..9
<br>
 See the example below for the constants to control fixed mode PWM using PWM modules.</p></td></tr><tr><td align="left" valign="top"><p>PWMOff( <code class="literal">channel</code>, PWMMODULE )</p></td><td align="left" valign="top"><p>Where the parameter is any valid CCP/PWM module</p></td><td align="left" valign="top"><p><code class="literal">module</code> can be 1..9</p></td></tr></tbody></table></div><p><br>
<br>
<span class="strong"><strong>Fixed Mode PWM for PWM Modules.</strong></span></p><p>To set the Fixed Mode PWM for PWM Modules you need to set a timer frequency, a PWM module cycle and the PWM model source clock.</p><p>The options for source clock are shown below.    These are the PWM timers supported by the PWM modules, where <code class="literal">nn</code> is the frequency.</p><pre class="screen">    PWM_Timer2_Freq `nn` or
    PWM_Timer4_Freq `nn` or
    PWM_Timer6_Freq `nn`.</pre><p>The PWM module duty is set using PWM_`yy`_Duty <code class="literal">xx' where `yy</code> is between 1 and 9 and is a valid PWM module, and, <code class="literal">xx</code> is the Duty cycle for specific channels</p><pre class="screen">    #define PWM_yy_Duty xx</pre><p>The PMW module clock source us PWM_`zz`_Clock_Source <code class="literal">tt</code>.  Where <code class="literal">zz</code> is channel and <code class="literal">tt</code> is the PWM clock source.</p><pre class="screen">    #define PMW_zz_Clock_Source tt</pre><p>You do not need to define all the timers and or all the channels, just define the constants you need.</p><p>The minimum is
    A timer with a frequency
    A PWM channel with a duty
    A PWM channel clock source</p><p>Example: For PWM channel 6 with a frequency of 38Khz with a duty of 50% with a clock source of timer 2, use</p><pre class="screen">        #define PWM_Timer2_Freq 38
        #define PWM_7_Duty 50
        #define PMW_7_Clock_Source 6</pre><p>Details of the constants with  example parameters.</p><pre class="literallayout">#define PWM_Timer2_Freq 20        'Set frequency in KHz, just change the number
#define PWM_Timer4_Freq 40        'Set frequency in KHz, just change the number
#define PWM_Timer6_Freq 60        'Set frequency in KHz, just change the number</pre><p>Supported PWM modules, with example parameters.</p><pre class="literallayout">#define PWM_1_Duty 10            'Set duty cycle as percentage 0-100%, just change the number
#define PMW_1_Clock_Source 2</pre><pre class="literallayout">#define PWM_2_Duty 20
#define PMW_2_Clock_Source 4</pre><pre class="literallayout">#define PWM_3_Duty 30
#define PMW_3_Clock_Source 6</pre><pre class="literallayout">#define PWM_4_Duty 40
#define PMW_4_Clock_Source 2</pre><pre class="literallayout">#define PWM_5_Duty 50
#define PMW_5_Clock_Source 6</pre><pre class="literallayout">#define PWM_6_Duty 60
#define PMW_6_Clock_Source 6</pre><pre class="literallayout">#define PWM_7_Duty 70
#define PMW_7_Clock_Source 4</pre><pre class="literallayout">#define PWM_8_Duty 80
#define PMW_8_Clock_Source 4</pre><pre class="literallayout">#define PWM_9_Duty 90
#define PMW_9_Clock_Source 6</pre><p><br>
<br>
<span class="strong"><strong>Example #1:</strong></span></p><p>Enable CCP1/PWM channel only.  This is the legacy command.</p><pre class="screen">    #chip 16f877a,20

    'Set the PWM pin to output mode
    DIR PORTC.2 out

    'Main code

    #define PWM_Freq 38      'Frequency of PWM in KHz
    #define PWM_Duty 50      'Duty cycle of PWM (%)

    PWMOn    'Will enable CCP1/PWM Only

    wait 10 s                'Wait 10 s

    PWMOff   'Will disable CCP1/PWM Only

    do
    loop</pre><p><br>
<span class="strong"><strong>Example #2:</strong></span></p><p>Enable any CCP/PWM channel using a call to a method.</p><pre class="screen">    #chip 16f877a,20

    'Set the PWM pin to output mode
    DIR PORTC.2 out

    'Main code

    #define PWM_Freq 38      'Frequency of PWM in KHz
    #define PWM_Duty 50      'Duty cycle of PWM (%)

    PWMOn (2)    'Will enable any valid CCP/PWM channel

    wait 10 s                'Wait 10 s

    PWMOff (2)   'Will disable any valid CCP/PWM channel

    do
    loop</pre><p><br>
Example #3:*</p><p>Enable any PWM module using a PWM specific method.</p><pre class="screen">    'A real simple and easy PWM setup for 8 and 10 bit PWM channels
        #chip 18f25k42, 16

        #startup InitPPS, 85

        Sub InitPPS

                'Module: PWM5
                RA0PPS = 0x000D    'PWM5 &gt; RA0
                'Module: PWM6
                RA1PPS = 0x000E    'PWM6 &gt; RA1
                'Module: PWM7
                RA2PPS = 0x000F    'PWM7 &gt; RA2
                'Module: PWM8
                RA3PPS = 0x0010    'PWM8 &gt; RA3

        End Sub

        'Template comment at the end of the config file
        dir porta Out
        dir portb Out
        dir portc Out

    'This is the setup section for fixed mode PWM

        'The only options are PWM_Timer2_Freq nn|PWM_Timer4_Freq nn|PWM_Timer6_Freq nn. These are the PWM timers
        'The PWM_yy_Duty xx' where yy is between 1 and 9 and is a valid PWM module, and, xx is the Duty cycle for specific channels
        'The PMW_zz_Clock_Source tt.  Where zz is channel and tt is the PWM clock source.
        'You do not need to define all the timers and channels, just define the constants you need.
        'The minimum is
        '   A timer with a frequency
        '   A PWM channel with a duty
        '   A PWM channel clock source
        '   For PWM channel 2 with a frequency of 38Khz with a duty of 50% with a clock source of timer 2, use
        '     #define PWM_Timer2_Freq 38
        '     #define PWM_7_Duty 50
        '     #define PMW_7_Clock_Source 2

        #define PWM_Timer2_Freq 20        'Set frequency in KHz, just change the number
        #define PWM_Timer4_Freq 40        'Set frequency in KHz, just change the number
        #define PWM_Timer6_Freq 60        'Set frequency in KHz, just change the number


      '    Supported PWM module but not by this specific microcontroller
      '
      '    #define PWM_1_Duty 10            'Set duty cycle as percentage 0-100%, just change the number
      '    #define PMW_1_Clock_Source 2
      '
      '    #define PWM_2_Duty 20
      '    #define PMW_2_Clock_Source 4
      '
      '    #define PWM_3_Duty 30
      '    #define PMW_3_Clock_Source 6
      '
      '    #define PWM_4_Duty 40
      '    #define PMW_4_Clock_Source 2

        #define PWM_5_Duty 50
        #define PMW_5_Clock_Source 6

        #define PWM_6_Duty 60
        #define PMW_6_Clock_Source 6

        #define PWM_7_Duty 70
        #define PMW_7_Clock_Source 4

        #define PWM_8_Duty 80
        #define PMW_8_Clock_Source 4

        '    Supported PWM module but not by this specific microcontroller
        '
        '    #define PWM_9_Duty 90
        '    #define PMW_9_Clock_Source 6


        '   Enable module 7
        HPWMOn ( 7, PWMModule )
        wait 2 s
        '   Disable channel 7
        HPWMOff ( 7, PWMModule)
        '    wait 2 s

        '   Enable others module
        HPWMOn ( 5, PWMModule )
        HPWMOn ( 6, PWMModule )
        HPWMOn ( 7, PWMModule )
        HPWMOn ( 8, PWMModule )

        '  Enable CCP/PWM channel 1  - uses constants FREQ and DUTY
        PWMOn

        '  Enable CCP/PWM channel 2
        PWMOn ( 2 )
        do
        loop

    End</pre><p><br>
<br></p><p><br></p><p><span class="strong"><strong>For more help, see</strong></span> <a class="link" href="_pwmon.html" title="PWMOn">PWMOn</a> and <a class="link" href="_pwmoff.html" title="PWMOff">PWMOff</a> <span class="strong"><strong>or, for AVR see</strong></span> <a class="link" href="_hpwm_fixed_mode_for_avr.html" title="HPWM Fixed Mode for AVR">Fixed Mode PWM for AVR</a></p></div></body></html>