<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>PWMOut</title><link rel="stylesheet" type="text/css" href="gcbdoc.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="GCBASIC documentation"><link rel="up" href="_pwm_software_mode.html" title="PWM Software Mode"><link rel="prev" href="_pwm_software_mode.html" title="PWM Software Mode"><link rel="next" href="_hpwm_ccp.html" title="HPWM CCP"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="section"><div class="titlepage"><div><div><h6 class="title"><a name="_pwmout"></a>PWMOut</h6></div></div></div><p><span class="strong"><strong>Syntax:</strong></span></p><pre class="screen">    PWMOut <span class="emphasis"><em>channel, duty cycle, cycles</em></span></pre><p><span class="strong"><strong>Command Availability:</strong></span></p><p>Available on all microcontrollers.  This method does NOT require a PWM module within the microcontroller.</p><p>This command uses a software PWM routine within GCBASIC to produce
a PWM signal on the selected port of the chip.</p><p>The method <code class="literal">PWMOut</code> does not make use of any special hardware within the microcontroller.
The PWM signal is generated only while the <code class="literal">PWMOut</code> command is executing - therefore, when the <code class="literal">PWMOut</code> is not executing
by moving onto the next command, the PWM signal will stop.</p><p><span class="strong"><strong>Explanation :</strong></span></p><p><code class="literal"><span class="emphasis"><em>channel</em></span></code> sets the channel that the PWM is to be generated on. This must
have been defined previously by setting the constants <code class="literal">PWM_Out1</code><br></p><p><code class="literal">PWM_Out2</code>, <code class="literal">PWM_Out3</code> or <code class="literal">PWM_Out4</code>. The maximum number of channels available
is 4.<br></p><p><code class="literal"><span class="emphasis"><em>duty cycle</em></span></code> specifies the PWM duty cycle, and ranges from 0 to 255. 255
corresponds to 100%, 127 to 50%, 63 to 25%, and so on.<br></p><p><code class="literal"><span class="emphasis"><em>cycles</em></span></code> is used to set the amount of PWM pulses to supply. This is
useful for situations in which a pulse of a specific length is required.<br></p><p>The formula for calculating the time taken for one cycle is:<br></p><pre class="screen">    T<sub>CYCLE</sub> = (28 + 10C)T<sub>OSC</sub>+ (255 * PWM_Delay)</pre><p>where: <br></p><p>&nbsp;&nbsp;&nbsp;-C is the number of channels used<br>
&nbsp;&nbsp;&nbsp;-T<sub>OSC</sub> is the length of time taken to execute 1 instruction on the chip (0.2 us on a 20 MHz chip, 1
us on a 4 Mhz chip)<br>
&nbsp;&nbsp;&nbsp;-PWM_Delay is a length of time specified using the <code class="literal">PWM_Delay</code> constant<br></p><p><span class="strong"><strong>Example 1 :</strong></span></p><pre class="screen">    'This program controls the brightness of an LED on PORTB.0
    'using the software PWM routine and a potentiometer.
    #chip 16f877a, 20

    ; ----- Constants
    'PWM constant. This is a required constant.
    #define PWM_Out1 portb.0

    ; ---- Optional Constant to add an delay after PWM pulse
    ''#Define PWM_Delay 1 us


    ; ----- Define Hardware settings
    'PWM port out.  This is not required but good practice.
    dir PWM_Out1 out

    'A potentiometer is attached to ANO

    ; ----- Variables
    ' No Variables specified in this example.

    ; ----- Main body of program commences here.
      do
          '100 cycles is a purely arbitrary value as the loop will maintain a relatively constant PWM
          PWMOut 1, ReadAD(AN0), 100
      loop

end</pre><p><span class="strong"><strong>Example 2 :</strong></span></p><pre class="screen">    'This program controls the brightness of an LED on gpio.1
    'using the software PWM routine and a potentiometer.
    #chip 12f675, 4

    ; ----- Constants
      'PWM constant. This is a required constant.
      #define PWM_Out1 gpio.1

    ; ----- Define Hardware settings
      'PWM port out.  This is not required but good practice.
      dir PWM_Out1 out

      'A potentiometer is attached to ANO

    ; ----- Variables
      ' No Variables specified in this example.

    ; ----- Main body of program commences here.
        do
          '100 cycles is a purely arbitrary value
            PWMOut 1, ReadAD(AN0), 100
        loop
    end</pre></div></body></html>