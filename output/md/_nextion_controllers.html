<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>NEXTION Controllers</title><link rel="stylesheet" type="text/css" href="gcbdoc.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="GCBASIC documentation"><link rel="up" href="_glcd_overview.html" title="GLCD Overview"><link rel="prev" href="_ks0108_controllers.html" title="KS0108 Controllers"><link rel="next" href="_nt7108c_controllers.html" title="NT7108C Controllers"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="_nextion_controllers"></a>NEXTION Controllers</h5></div></div></div><p>This section covers GLCD devices that use the serially attached Nextion graphics displays.</p><p>Nextion includes hardware part (a series of TFT boards) and software part (the Nextion
editor (<a class="link" href="http://nextion.itead.cc/)" target="_top">http://nextion.itead.cc/)</a>).</p><p>The Nextion TFT board uses only one serial port to communicate. &nbsp;&nbsp;It lets you avoid the hassle of wiring.&nbsp;&nbsp;Nextion
editor has mass components such as button, text, progress bar, slider, instrument panel etc.
to enrich your interface design.&nbsp;&nbsp; And, the drag-and-drop function ensures that you spend less
time in programming</p><p>The Nextion displays are 2.4 to 7.0 inches and range from 320*240 to 800*480 pixels.&nbsp;&nbsp; The connections are 5v, 0v, SerialIn and SerialOut.&nbsp;&nbsp; GCBASIC supports hardware and software serial connectivity.</p><p>See GITHUB for the set of GCBASIC demonstrations fro the Nextion displays.  See <a class="link" href="https://github.com/Anobium/Great-Cow-BASIC-Demonstration-Sources/tree/master/GLCD%20%20Solutions/GLCD%20Nextion%20Solutions" target="_top">Nextion demonstrations on GITHUB</a>.</p><p><br>
<br>
<br>
<br>
To use the Nextion driver simply include the following in your user code.  This will initialise the driver.
<br>
<br>
<span class="strong"><strong>Setup for Hardware Serial</strong></span></p><pre class="screen">' ----- Configuration
    'Chip Settings.
    #chip 16f18855,32
    #option explicit

' ----- Set up the Nextion GLCD
    #include &lt;glcd.h&gt;
    #define GLCD_TYPE GLCD_TYPE_Nextion


    ;VERY IMPORTANT!!
    ;Change the width and height to match the rotation in the Nextion Editor
    #define GLCD_WIDTH  320   'could be 320 | 400 | 272 | 480 but any valid dimension will work.
    #define GLCD_HEIGHT 240  'could be 240 | 480 | 800 but any valid dimension will work.


    ;VERY IMPORTANT!!
    ;Fonts installed in the Nextion MUST match the fonts parameters loading to the GLCD.
    ;Obtain parameters from Nextion Editor/Font dialog.
    #define NextionFont0      0, 8, 16    'Arial 8x16
    #define NextionFont1      1, 12, 24   '24point 12x24 charset
    #define NextionFont2      2, 16, 32   '32point 16x32 charset

' ----- End of set up for Nextion GLCD

' ----- Set up for Hardware Serial
    ;VERY IMPORTANT!!
    ;The Nextion MUST be setup for 9600 bps.
    #define USART_BAUD_RATE 9600
    #define USART_BLOCKING

    ;VERY IMPORTANT!!
    ;These two are optional. These constants are set in the library.
    #define GLCD_NextionSerialPrint HSerPrint
    #define GLCD_NextionSerialSend  HSerSend

' ----- End of set up for Serial


    'Generated by PIC PPS Tool for GCBASIC
    'PPS Tool version: 0.0.5.11
    'PinManager data: v1.55
    '
    'Template comment at the start of the config file
    '
    #startup InitPPS, 85

    Sub InitPPS

            'Module: EUSART
            RXPPS = 0x0016    'RC6 &gt; RX

            'Module: EUSART
            RC0PPS = 0x0010    'TX &gt; RC0
            TXPPS = 0x0010    'RC0 &gt; TX (bi-directional)
            RC5PPS = 0x0010    'TX &gt; RC5
            TXPPS = 0x0015    'RC5 &gt; TX (bi-directional)

    End Sub
    'Template comment at the end of the config file


' ----- Main program starts
....</pre><p><br>
<br>
<span class="strong"><strong>Setup for Software Serial</strong></span></p><pre class="screen">' ----- Configuration
    'Chip Settings.
    #chip 16f18855,32
    #option explicit

' ----- Set up the Nextion GLCD
    #include &lt;glcd.h&gt;
    #define GLCD_TYPE GLCD_TYPE_Nextion


    ;VERY IMPORTANT!!
    ;Change the width and height to match the rotation in the Nextion Editor
    #define GLCD_WIDTH  320   'could be 320 | 400 | 272 | 480 but any valid dimension will work.
    #define GLCD_HEIGHT 240  'could be 240 | 480 | 800 but any valid dimension will work.


    ;VERY IMPORTANT!!
    ;Fonts installed in the Nextion MUST match the fonts parameters loading to the GLCD.
    ;Obtain parameters from Nextion Editor/Font dialog.
    #define NextionFont0      0, 8, 16    'Arial 8x16
    #define NextionFont1      1, 12, 24   '24point 12x24 charset
    #define NextionFont2      2, 16, 32   '32point 16x32 charset

' ----- End of set up for Nextion GLCD

' ----- Set up for Software Serial - this is optional - shown to explain the method.
    ;Remove Hardware Serial before using Software serial
    ;You MUST also remove PPS setup, for hardware serial, when using Software serial
    #include &lt;SoftSerial.h&gt;

    ; ----- Config Serial UART for sending:
    #define SER1_BAUD 9600     ; baudrate must be defined
    #define SER1_TXPORT PORTC ; I/O port (without .bit) must be defined
    #define SER1_TXPIN 5       ; portbit  must be defined

    ;VERY IMPORTANT!!
    ;These two constants are required to support the the library.
    #define GLCD_NextionSerialPrint        Ser1Print
    #define GLCD_NextionSerialSend         Ser1Send
'
' ----- End of set up for Serial

' ----- Main program starts</pre><p><br>
<br></p><p>The GCBASIC constants shown below control the configuration of the Nextion controller.
&nbsp;&nbsp;&nbsp;The GCBASIC constants for control and data line connections are shown
in the table below.</p><p><br>
<br></p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="left" valign="top">Constants</th><th align="left" valign="top">Controls</th><th align="left" valign="top">Options</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">GLCD_TYPE</code></p></td><td align="left" valign="top"><p><code class="literal">GLCD_TYPE_Nextion</code></p></td><td align="left" valign="top">&nbsp;</td></tr><tr><td align="left" valign="top"><p><code class="literal">GLCD_NextionSerialPrint</code></p></td><td align="left" valign="top"><p>Default is <code class="literal">HSerPrint</code> for hardware serial can be <code class="literal">SernPrint</code> when using software serial.</p></td><td align="left" valign="top"><p>Required</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">GLCD_NextionSerialSend</code></p></td><td align="left" valign="top"><p>Default is <code class="literal">HSerSend</code> for hardware serial can be <code class="literal">SernSend</code> when using software serial.</p></td><td align="left" valign="top"><p>Required</p></td></tr></tbody></table></div><p><br>
<br>
The GCBASIC constants for control display characteristics are shown in the table below.
<br>
<br></p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="left" valign="top">Constants</th><th align="left" valign="top">Controls</th><th align="left" valign="top">Default</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">GLCD_WIDTH</code></p></td><td align="left" valign="top"><p>Mandated. The width parameter of the GLCD</p></td><td align="left" valign="top"><p><code class="literal">320</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">GLCD_HEIGHT</code></p></td><td align="left" valign="top"><p>Mandated. The height parameter of the GLCD</p></td><td align="left" valign="top"><p><code class="literal">480</code></p></td></tr></tbody></table></div><p><br>
<br></p><p>The GCBASIC Nextion specific commands supported for this GLCD are shown in the table below.&nbsp;&nbsp;&nbsp;Always review the appropiate library for the latest full set of supported commands.
<br>
<br></p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="left" valign="top">Command</th><th align="left" valign="top">Purpose</th><th align="left" valign="top">Example</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">GLCDPrint_Nextion</code></p></td><td align="left" valign="top"><p>Print string of characters on GLCD using Nextion font set</p></td><td align="left" valign="top"><p><code class="literal">GLCDPrint( Xposition, Yposition, Stringvariable [,NextionFont] )</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">GLCDLocateString_Nextion</code></p></td><td align="left" valign="top"><p>Locate the screen coordinates at a specific location.</p></td><td align="left" valign="top"><p><code class="literal">GLCDLocateString_Nextion( Xposition, Yposition)</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">GLCDPrintString_Nextion</code></p></td><td align="left" valign="top"><p>Print string of characters on GLCD using Nextion font set</p></td><td align="left" valign="top"><p><code class="literal">GLCDPrintString_Nextion( Stringvariable )</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">GLCDPrintStringLn_Nextion</code></p></td><td align="left" valign="top"><p>Print string of characters on GLCD using Nextion font set adding a newline and carriage return to move cursort to start of next line.</p></td><td align="left" valign="top"><p><code class="literal">GLCDPrintStringLn_Nextion( Stringvariable )</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">GLCDSendOpInstruction_Nextion</code></p></td><td align="left" valign="top"><p>Send the Nextion display a specific command and a specific value</p></td><td align="left" valign="top"><p><code class="literal">GLCDSendOpInstruction_Nextion( Nextion_command, command_value )</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">GLCDUpdateObject_Nextion</code></p></td><td align="left" valign="top"><p>Update a Nextion display object with a specific value</p></td><td align="left" valign="top"><p><code class="literal">GLCDUpdateObject_Nextion( Nextion_object, object_value )</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">myReturnedWordValue  = GLCDGetTouch_Nextion( "nextion_command_string" )</code></p></td><td align="left" valign="top"><p>A function that returns a long, that can be treated as word variable, value of the Touch event..&nbsp;&nbsp;As follows:
<br>
<br>
"tch0" for current x co-ordinate touched
</p><p>"tch1" for current y co-ordinate touched
</p><p>"tch2" for last x co-ordinate touched
</p><p>"tch3" for last y co-ordinate touched
<br>
<br>
The function is non-blocking.
</p><p>1. Checks for three bytes of 0xFF. If Four 0xff are received then exit = non-block.
</p><p>2. If at any time a 0x71 is recieved then we have data for the event.
</p><p>3. If seven bytes arrive, but the method did not receive a 0x71  then exit = non-block.
</p><p>4. The method supports software and hardware serial. As does all the other methods.
</p><p>5. The method uses a function to receive the data not a sub-routine.
</p><p>6. The method returns 0xBEEF if there is an invalid read, and, functional value for GLCDGetTouch_Nextion will also be set to 0xDEADBEEF</p></td><td align="left" valign="top"><p>myReturnedWordValue  = GLCDGetTouch_Nextion( "tch2")
</p><p>or,
</p><p>myReturnedWordValue  = GLCDGetTouch_Nextion( "tch3")</p></td></tr></tbody></table></div><p><br>
<br></p><p>The GCBASIC commonn commands supported for this GLCD are shown in the table below.&nbsp;&nbsp;&nbsp;Always review the appropiate library for the latest full set of supported commands.
<br>
<br></p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="left" valign="top">Command</th><th align="left" valign="top">Purpose</th><th align="left" valign="top">Example</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">GLCDCLS</code></p></td><td align="left" valign="top"><p>Clear screen of GLCD</p></td><td align="left" valign="top"><p><code class="literal">GLCDCLS  [,Optional LineColour]</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">GLCDPrint</code></p></td><td align="left" valign="top"><p>Print string of characters on GLCD using GCB font set</p></td><td align="left" valign="top"><p><code class="literal">GLCDPrint( Xposition, Yposition, Stringvariable )</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">GLCDDrawChar</code></p></td><td align="left" valign="top"><p>Print character on GLCD using GCB font set</p></td><td align="left" valign="top"><p><code class="literal">GLCDDrawChar( Xposition, Yposition, CharCode [,Optional LineColour] )</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">GLCDDrawString</code></p></td><td align="left" valign="top"><p>Print characters on GLCD using GCB font set</p></td><td align="left" valign="top"><p><code class="literal">GLCDDrawString( Xposition, Yposition, Stringvariable [,Optional LineColour] )</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">Box</code></p></td><td align="left" valign="top"><p>Draw a box on the GLCD to a specific size</p></td><td align="left" valign="top"><p><code class="literal">Box ( Xposition1, Yposition1, Xposition2, Yposition2 [,Optional LineColour]</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">FilledBox</code></p></td><td align="left" valign="top"><p>Draw a box on the GLCD to a specific size that is filled with the foreground colour.</p></td><td align="left" valign="top"><p><code class="literal">FilledBox (Xposition1, Yposition1, Xposition2, Yposition2  [,Optional LineColour] )</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">Line</code></p></td><td align="left" valign="top"><p>Draw a line on the GLCD to a specific length that is filled with the specific attribute.</p></td><td align="left" valign="top"><p><code class="literal">Line ( Xposition1, Yposition1, Xposition2, Yposition2 [,Optional LineColour] )</code></p></td></tr></tbody></table></div><p><br>
<br></p><pre class="screen">    TFT_BLACK   'hexidecimal value 0x0000
    TFT_RED     'hexidecimal value 0xF800
    TFT_GREEN   'hexidecimal value 0x0400
    TFT_BLUE    'hexidecimal value 0x001F
    TFT_WHITE   'hexidecimal value 0xFFFF
    TFT_PURPLE  'hexidecimal value 0xF11F
    TFT_YELLOW  'hexidecimal value 0xFFE0
    TFT_CYAN    'hexidecimal value 0x07FF
    TFT_D_GRAY  'hexidecimal value 0x528A
    TFT_L_GRAY  'hexidecimal value 0x7997
    TFT_SILVER  'hexidecimal value 0xC618
    TFT_MAROON  'hexidecimal value 0x8000
    TFT_OLIVE   'hexidecimal value 0x8400
    TFT_LIME    'hexidecimal value 0x07E0
    TFT_AQUA    'hexidecimal value 0x07FF
    TFT_TEAL    'hexidecimal value 0x0410
    TFT_NAVY    'hexidecimal value 0x0010
    TFT_FUCHSIA 'hexidecimal value 0xF81F</pre><p><br>
<br></p><p><br>
<br></p><p><span class="strong"><strong>For more help, see</strong></span>
<a class="link" href="_glcdcls.html" title="GLCDCLS">GLCDCLS</a>
<br>
<br>
Supported in &lt;GLCD.H&gt;</p></div></body></html>