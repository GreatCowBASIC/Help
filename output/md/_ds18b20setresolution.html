<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>DS18B20SetResolution</title><link rel="stylesheet" type="text/css" href="gcbdoc.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="GCBASIC documentation"><link rel="up" href="_one_wire_devices.html" title="One Wire Devices"><link rel="prev" href="_readtemp12.html" title="ReadTemp12"><link rel="next" href="_serial_communications.html" title="Serial Communications"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_ds18b20setresolution"></a>DS18B20SetResolution</h4></div></div></div><p><span class="strong"><strong>Syntax:</strong></span></p><p>For Single Channel/Device only. The method assumes a single DS18B20 device on the OneWire bus.</p><pre class="screen">    DS18B20SetResolution ( [DS18B20SetResolution_CONTSTANT] )</pre><p><span class="strong"><strong>Command Availability:</strong></span></p><p>Available on all microcontrollers.</p><p><span class="strong"><strong>Explanation:</strong></span></p><p>Set the DS18B20 operating resolution.&nbsp;&nbsp;
The configuration register of the DS18B20 allows the user to set the resolution of the temperature-to-digital conversion to 9, 10, 11, or 12 bits. &nbsp;&nbsp;
This method set the operating resolution to either 9, 10, 11, or 12 bits.&nbsp;&nbsp;</p><p>Calling the method with no parameter will set the operating resolution of the DS18B20 to 12 bits.&nbsp;&nbsp;
See example 3 below.</p><p><span class="strong"><strong>Constants</strong></span></p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="left" valign="top">CONSTANT</th><th align="left" valign="top">Operating resolution</th><th align="left" valign="top">Temprature resolution</th></tr></thead><tbody><tr><td align="left" valign="top"><p>DS18B20_TEMP_9_BIT</p></td><td align="left" valign="top"><p>9 bits</p></td><td align="left" valign="top"><p>0.5c</p></td></tr><tr><td align="left" valign="top"><p>DS18B20_TEMP_10_BIT</p></td><td align="left" valign="top"><p>10 bits</p></td><td align="left" valign="top"><p>0.25c</p></td></tr><tr><td align="left" valign="top"><p>DS18B20_TEMP_11_BIT</p></td><td align="left" valign="top"><p>11 bits</p></td><td align="left" valign="top"><p>0.125c</p></td></tr><tr><td align="left" valign="top"><p>DS18B20_TEMP_12_BIT</p></td><td align="left" valign="top"><p>12 bits</p></td><td align="left" valign="top"><p>0.0625c</p></td></tr></tbody></table></div><p><br>
<span class="strong"><strong>Example Usage 1</strong></span></p><p>The follow example sets the operating resolution of the DS18B20 to 12 bits.</p><pre class="screen">    #include &lt;DS18B20.h&gt;
    #define DQ PortC.3 ; change port configuration as required
    DS18B20SetResolution ( DS18B20_TEMP_12_BIT )</pre><p><span class="strong"><strong>Example Usage 2</strong></span></p><p>The follow example sets the operating resolution of the DS18B20 to 9 bits.</p><pre class="screen">    #include &lt;DS18B20.h&gt;
    #define DQ PortC.3 ; change port configuration as required
    DS18B20SetResolution ( DS18B20_TEMP_9_BIT )</pre><p><span class="strong"><strong>Example Usage 3</strong></span></p><p>The follow example sets the operating resolution of the DS18B20 to the default value of 12 bits.</p><pre class="screen">    #include &lt;DS18B20.h&gt;
    #define DQ PortC.3 ; change port configuration as required
    DS18B20SetResolution ( )</pre><p><span class="strong"><strong>Working Example Program</strong></span></p><p>The following program will display the temperature on a serial attached LCD.&nbsp;&nbsp;
Change the <code class="literal">DS18B20SetResolution ()</code> method to set the resolution of a specific setting.</p><p>You may need to change the chip, edit/remove PPS, and/or the change LCD settings to make this program work with your configuration.&nbsp;&nbsp;</p><pre class="screen">#chip 16f18313
#config MCLR=ON
#option Explicit
#include &lt;ds18b20.h&gt;

    'Generated by PIC PPS Tool for GCBASIC
    'PPS Tool version: 0.0.6.1
    'PinManager data: v1.79.0
    'Generated for 16f18313
    '
    'Template comment at the start of the config file
    '
    #startup InitPPS, 85
    #define PPSToolPart 16f18313

    Sub InitPPS

            'Module: EUSART
            RA5PPS = 0x0014    'TX &gt; RA5

    End Sub
    'Template comment at the end of the config file

    'USART settings for USART1
    #define USART_BAUD_RATE 115200
    #define USART_TX_BLOCKING
    #define USART_DELAY OFF

    #define LCD_IO 107   'K107
    #define LCD_WIDTH 20                ;specified lcd width for clarity only.  20 is the default width


    ; ----- Constants
    ' DS18B20 port settings
    #define DQ RA4

; ----- Variables
  dim TempC_100 as LONG   ' a variabler to handle the temperature calculations
  Dim DSdata,WHOLE, FRACT, DIG as word
  Dim CCOUNT, SIGNBIT as Byte


; ----- Main body of program commences here.

    ccount = 0
    CLS
    print "GCBasic 2021"
    locate 1,0
    print "DS18B20 Demo"
    wait 2 s
    CLS

    DS18B20SetResolution ( DS18B20_TEMP_12_BIT )

    do forever
       ' The function readtemp returns the integer value of the sensor
       DSdata = readtemp

       ' Display the integer value of the sensor on the LCD
       locate 0,0
       print hex(ccount)
       print " Ceil"
       locate 0,8
       print DSdata
       print chr(223)+"C"



       ' Display the integer and decimal value of the sensor on the LCD

       ' The function readtemp12 returns the raw value of the sensor.
       ' The sensor is read as a 12 bit value therefore each unit equates to 0.0625 of a degree
       DSdata = readtemp12


       SignBit = DSdata / 256 / 128
       If SignBit = 0 Then goto Positive
       ' its negative!
       DSdata = ( DSdata # 0xffff ) + 1 ' take twos comp


    Positive:
       ' Convert value * 0.0625 by factorisation
       TempC_100 =  DSdata *  625
       Whole = TempC_100 / 10000
       Fract = TempC_100 % 10000


       If SignBit = 0 Then goto DisplayTemp
       Print "-"

    DisplayTemp:
       Locate 3,0
       Print Whole
       Print "."
       Print leftpad( str(Fract),4,"0")

       wait 2 s
       ccount++

    loop</pre><p><br>
<br></p></div></body></html>