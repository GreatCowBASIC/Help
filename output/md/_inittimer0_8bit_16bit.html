<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>InitTimer0 8bit/16bit</title><link rel="stylesheet" type="text/css" href="gcbdoc.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="GCBASIC documentation"><link rel="up" href="_inittimer0.html" title="InitTimer0"><link rel="prev" href="_inittimer0.html" title="InitTimer0"><link rel="next" href="_inittimer1.html" title="InitTimer1"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="_inittimer0_8bit_16bit"></a>InitTimer0 8bit/16bit</h5></div></div></div><p><span class="strong"><strong>Syntax:</strong></span></p><pre class="screen">    InitTimer0 source, prescaler + clocksource, postscaler</pre><p>Timer are useful as timers can generate interrupts.
Timers can be used in conjunction with <code class="literal">On Interrupt</code> to run a section of code when a specific timer event occurs.
Example events are when the timer matches a specific value, or, the timer resets to a zero value.
For more details on timer events see <code class="literal">On Interrupt</code>.</p><p><span class="strong"><strong>Command Availability:</strong></span></p><p>Available on microcontrollers with a Timer 0 where the timer has the capability of operating as an 8 bit or 16 bit timer.&nbsp;&nbsp;
This type of Timer 0 can be found on Microchip PIC 18(L)F, as well as small number of 18C and 16(L)F microcontrollers.&nbsp;&nbsp;
These timers can be configured for either 8-bit or 16-bit operation.</p><p>You may need to refer to the datasheet for your microcontroller to determine if it supports both 8-bit and 16-bit operations.</p><p><span class="strong"><strong>Explanation for 8-bit timer:</strong></span></p><p>The default operation is as an 8-bit timer.&nbsp;&nbsp;
<code class="literal">InitTimer0</code> will set up timer 0.</p><p>Parameters are required as shown in the table below:</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"></colgroup><thead><tr><th align="left" valign="top">Parameter</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal"><span class="emphasis"><em>source</em></span></code></p></td><td align="left" valign="top"><p>The clock source for this specific timer. Can be either <code class="literal">Osc</code> or <code class="literal">Ext</code> where`Osc` is an internal oscillator and <code class="literal">Ext</code> is an external oscillator.
</p><p><br>
<br>
<code class="literal">Osc</code> - Selects the clock source in use, as set by the microcontroller specific configuration (fuses or #config).&nbsp;&nbsp;This could be an internal clock or an external clock source ( external clock sources are typically attached to the XTAL pins).
</p><p><code class="literal">Ext</code> - Selects the clock source attached to a specific exernal interrupt input port.&nbsp;&nbsp;This allows a different clock frequency than the main clock to be used, such as 32.768 kHz crystals commonly used for real time circuits.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal"><span class="emphasis"><em>prescaler</em></span></code></p></td><td align="left" valign="top"><p>The value of the prescaler for this specific timer, <span class="strong"><strong>and</strong></span>, the clocksource
</p><p>See the tables below for permitted values for Microchip PIC or the Atmel AVR microcontrollers.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal"><span class="emphasis"><em>postscaler</em></span></code></p></td><td align="left" valign="top"><p>The value of the postscaler for this specific timer.
</p><p>See the tables below for permitted values for Microchip PIC or the Atmel AVR microcontrollers.</p></td></tr></tbody></table></div><p><span class="emphasis"><em>8 bit Example:</em></span></p><p>The example show in the <code class="literal">osc</code> as an internal source, a <code class="literal">prescaler</code> value of 256 witht the HFINTOSC <code class="literal">clocksource</code> and a <code class="literal">postscaler</code> value of 2</p><pre class="screen">    InitTimer0 Osc, PRE0_256 + TMR0_HFINTOSC ,  POST0_2
    'also, note when in 8-bit mode you MUST set the 8bit timer value to the upper byte of a WORD, when setting the `SetTimer`
    SetTimer 0, 0x5800   'Setting the HIGH byte!!!</pre><p><span class="emphasis"><em>16 bit Example:</em></span></p><p>To use the 16 bit timer you need to add the constant <code class="literal">#define TMR0_16bit</code>.</p><p>The example show in the <code class="literal">osc</code> as an internal source, a <code class="literal">prescaler</code> value of 256 witht the HFINTOSC <code class="literal">clocksource</code> and a <code class="literal">postscaler</code> value of 2</p><pre class="screen">    #define TMR0_16bit
    InitTimer0 Osc, PRE0_256 + TMR0_HFINTOSC ,  POST0_2</pre><p><span class="strong"><strong>Differences in Timer0 Operations</strong></span></p><p>The section refers to chips with a 8/16-bit Timer0.</p><p>When these chips are operating in 8-bit mode, Timer0 behaves much like Timers2/4/6. In 8-bit mode the TMR0H register does not increment. It instead becomes the Period or Match register and is aliased as "PR0"  (Period Register 0).</p><p>In 8-bit mode, Timer0 does not technically overflow. Instead when TMR0L increments and matches the value in the PR0 register, TMR0L is reset to 0. The interrupt flag bit (TMR0IF) bit is then set (based upon Postscaler).</p><p>The default value in the PR0 "match register" is 255.  This value can be set/changed in the user program to set/change the timer period. This can be used to fine tune the timer period.
<br>
<br></p><p><span class="strong"><strong>Timer 0 mandated constants:</strong></span></p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"></colgroup><thead><tr><th align="left" valign="top">Parameter</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal"><span class="emphasis"><em>source</em></span></code></p></td><td align="left" valign="top"><p>The clock source for this specific timer. Can be either <code class="literal">Osc</code> or <code class="literal">Ext</code> where <code class="literal">Osc</code> is an internal oscillator and <code class="literal">Ext</code> is an external oscillator.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal"><span class="emphasis"><em>prescaler</em></span></code></p></td><td align="left" valign="top"><p>The value of the prescaler for this specific timer.  See the tables below for permitted values for Microchip PIC or the Atmel AVR microcontrollers.
You may also be required to specify one of the following clock sources.<br>
<br>
<code class="literal">TMR0_CLC1</code><br>
<code class="literal">TMR0_SOSC</code><br>
<code class="literal">TMR0_LFINTOSC</code><br>
<code class="literal">TMR0_HFINTOSC</code><br>
<code class="literal">TMR0_FOSC4</code><br>
<code class="literal">TMR0_T0CKIPPS_Inverted</code><br>
<code class="literal">TMR0_T0CKIPPS_True</code><br>
<br>
</p><p>You should use a simple addition to concatenate the prescaler with a specific clock source. For example.
<br>
<br>
<code class="literal">PRE0_16</code> + <code class="literal">TMR0_HFINTOSC</code>
<br>
 <br></p></td></tr><tr><td align="left" valign="top"><p><code class="literal"><span class="emphasis"><em>postscaler</em></span></code></p></td><td align="left" valign="top"><p>See the tables below for permitted values for Microchip.<br>
Also, refer to the specific datasheet <code class="literal"><span class="emphasis"><em>postcaler</em></span></code> values.</p></td></tr></tbody></table></div><p><br>
<br>
Microchip PIC microcontrollers where the <code class="literal"><span class="emphasis"><em>prescaler</em></span></code> rate select bits are in the range of 1 to 32768  you should use one of the following constants.</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="center" valign="top"><span class="strong"><strong>Prescaler Value</strong></span></th><th align="left" valign="top"><span class="strong"><strong>Primary GCB Constant</strong></span></th><th align="center" valign="top"><span class="strong"><strong>Constant Equates<br>
to value</strong></span></th></tr></thead><tbody><tr><td align="center" valign="top"><p>1:1</p></td><td align="left" valign="top"><p><code class="literal">PRE0_1</code></p></td><td align="center" valign="top"><p>0</p></td></tr><tr><td align="center" valign="top"><p>1:2</p></td><td align="left" valign="top"><p><code class="literal">PRE0_2</code></p></td><td align="center" valign="top"><p>1</p></td></tr><tr><td align="center" valign="top"><p>1:4</p></td><td align="left" valign="top"><p><code class="literal">PRE0_4</code></p></td><td align="center" valign="top"><p>2</p></td></tr><tr><td align="center" valign="top"><p>1:8</p></td><td align="left" valign="top"><p><code class="literal">PRE0_8</code></p></td><td align="center" valign="top"><p>3</p></td></tr><tr><td align="center" valign="top"><p>1:16</p></td><td align="left" valign="top"><p><code class="literal">PRE0_16</code></p></td><td align="center" valign="top"><p>4</p></td></tr><tr><td align="center" valign="top"><p>1:32</p></td><td align="left" valign="top"><p><code class="literal">PRE0_32</code></p></td><td align="center" valign="top"><p>5</p></td></tr><tr><td align="center" valign="top"><p>1:64</p></td><td align="left" valign="top"><p><code class="literal">PRE0_64</code></p></td><td align="center" valign="top"><p>6</p></td></tr><tr><td align="center" valign="top"><p>1:128</p></td><td align="left" valign="top"><p><code class="literal">PRE0_128</code></p></td><td align="center" valign="top"><p>7</p></td></tr><tr><td align="center" valign="top"><p>1:256</p></td><td align="left" valign="top"><p><code class="literal">PRE0_256</code></p></td><td align="center" valign="top"><p>8</p></td></tr><tr><td align="center" valign="top"><p>1:512</p></td><td align="left" valign="top"><p><code class="literal">PRE0_512</code></p></td><td align="center" valign="top"><p>9</p></td></tr><tr><td align="center" valign="top"><p>1:1024</p></td><td align="left" valign="top"><p><code class="literal">PRE0_1024</code></p></td><td align="center" valign="top"><p>10</p></td></tr><tr><td align="center" valign="top"><p>1:2048</p></td><td align="left" valign="top"><p><code class="literal">PRE0_2048</code></p></td><td align="center" valign="top"><p>11</p></td></tr><tr><td align="center" valign="top"><p>1:4096</p></td><td align="left" valign="top"><p><code class="literal">PRE0_4096</code></p></td><td align="center" valign="top"><p>12</p></td></tr><tr><td align="center" valign="top"><p>1:8192</p></td><td align="left" valign="top"><p><code class="literal">PRE0_8192</code></p></td><td align="center" valign="top"><p>13</p></td></tr><tr><td align="center" valign="top"><p>1:16384</p></td><td align="left" valign="top"><p><code class="literal">PRE0_16384</code></p></td><td align="center" valign="top"><p>14</p></td></tr><tr><td align="center" valign="top"><p>1:32768</p></td><td align="left" valign="top"><p><code class="literal">PRE0_32768</code></p></td><td align="center" valign="top"><p>15</p></td></tr></tbody></table></div><p>These correspond to a prescaler of between 1:1 and 1:32768 of the oscillator
speed where the oscillator speed is (FOSC/4). The prescaler applies to
both the internal oscillator or the external clock.</p><p><br>
<br></p><p>On Microchip PIC microcontrollers where the <code class="literal"><span class="emphasis"><em>prescaler</em></span></code> rate select bits are in the range of 2 to 256  you should use one of the following constants.  If the <code class="literal"><span class="emphasis"><em>prescaler</em></span></code> rate select bits are in the range of 1 to 32768 then see the subsequent table.</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="center" valign="top"><span class="strong"><strong>Prescaler Value</strong></span></th><th align="left" valign="top"><span class="strong"><strong>Primary GCB Constant</strong></span></th><th align="center" valign="top"><span class="strong"><strong>Constant Equates<br>
to value</strong></span></th></tr></thead><tbody><tr><td align="center" valign="top"><p>1:2</p></td><td align="left" valign="top"><p><code class="literal">PS0_2</code></p></td><td align="center" valign="top"><p>0</p></td></tr><tr><td align="center" valign="top"><p>1:4</p></td><td align="left" valign="top"><p><code class="literal">PS0_4</code></p></td><td align="center" valign="top"><p>1</p></td></tr><tr><td align="center" valign="top"><p>1:8</p></td><td align="left" valign="top"><p><code class="literal">PS0_8</code></p></td><td align="center" valign="top"><p>2</p></td></tr><tr><td align="center" valign="top"><p>1:16</p></td><td align="left" valign="top"><p><code class="literal">PS0_16</code></p></td><td align="center" valign="top"><p>3</p></td></tr><tr><td align="center" valign="top"><p>1:32</p></td><td align="left" valign="top"><p><code class="literal">PS0_32</code></p></td><td align="center" valign="top"><p>4</p></td></tr><tr><td align="center" valign="top"><p>1:64</p></td><td align="left" valign="top"><p><code class="literal">PS0_64</code></p></td><td align="center" valign="top"><p>5</p></td></tr><tr><td align="center" valign="top"><p>1:128</p></td><td align="left" valign="top"><p><code class="literal">PS0_128</code></p></td><td align="center" valign="top"><p>6</p></td></tr><tr><td align="center" valign="top"><p>1:256</p></td><td align="left" valign="top"><p><code class="literal">PS0_256</code></p></td><td align="center" valign="top"><p>7</p></td></tr></tbody></table></div><p>These correspond to a prescaler of between 1:2 and 1:256 of the oscillator
speed where the oscillator speed is (FOSC/4). The prescaler applies to
both the internal oscillator or the external clock.
<br>
<br></p><p>On Microchip PIC microcontroller that require <code class="literal"><span class="emphasis"><em>postscaler</em></span></code> is can be one of the following constants where the Postscaler Rate Select bits are in the range of 1 to 16.</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="center" valign="top"><span class="strong"><strong>Postcaler Value</strong></span></th><th align="left" valign="top"><span class="strong"><strong>Primary GCB Constant</strong></span></th><th align="center" valign="top"><span class="strong"><strong>Use Numeric Constant</strong></span></th></tr></thead><tbody><tr><td align="center" valign="top"><p>1:1</p></td><td align="left" valign="top"><p><code class="literal">POST0_1</code></p></td><td align="center" valign="top"><p>0</p></td></tr><tr><td align="center" valign="top"><p>1:2</p></td><td align="left" valign="top"><p><code class="literal">POST0_2</code></p></td><td align="center" valign="top"><p>1</p></td></tr><tr><td align="center" valign="top"><p>1:3</p></td><td align="left" valign="top"><p><code class="literal">POST0_3</code></p></td><td align="center" valign="top"><p>2</p></td></tr><tr><td align="center" valign="top"><p>1:4</p></td><td align="left" valign="top"><p><code class="literal">POST0_4</code></p></td><td align="center" valign="top"><p>3</p></td></tr><tr><td align="center" valign="top"><p>1:5</p></td><td align="left" valign="top"><p><code class="literal">POST0_5</code></p></td><td align="center" valign="top"><p>4</p></td></tr><tr><td align="center" valign="top"><p>1:6</p></td><td align="left" valign="top"><p><code class="literal">POST0_6</code></p></td><td align="center" valign="top"><p>5</p></td></tr><tr><td align="center" valign="top"><p>1:7</p></td><td align="left" valign="top"><p><code class="literal">POST0_7</code></p></td><td align="center" valign="top"><p>6</p></td></tr><tr><td align="center" valign="top"><p>1:8</p></td><td align="left" valign="top"><p><code class="literal">POST0_8</code></p></td><td align="center" valign="top"><p>7</p></td></tr><tr><td align="center" valign="top"><p>1:9</p></td><td align="left" valign="top"><p><code class="literal">POST0_9</code></p></td><td align="center" valign="top"><p>8</p></td></tr><tr><td align="center" valign="top"><p>1:10</p></td><td align="left" valign="top"><p><code class="literal">POST0_10</code></p></td><td align="center" valign="top"><p>9</p></td></tr><tr><td align="center" valign="top"><p>1:11</p></td><td align="left" valign="top"><p><code class="literal">POST0_11</code></p></td><td align="center" valign="top"><p>10</p></td></tr><tr><td align="center" valign="top"><p>1:12</p></td><td align="left" valign="top"><p><code class="literal">POST0_12</code></p></td><td align="center" valign="top"><p>11</p></td></tr><tr><td align="center" valign="top"><p>1:13</p></td><td align="left" valign="top"><p><code class="literal">POST0_13</code></p></td><td align="center" valign="top"><p>12</p></td></tr><tr><td align="center" valign="top"><p>1:14</p></td><td align="left" valign="top"><p><code class="literal">POST0_14</code></p></td><td align="center" valign="top"><p>13</p></td></tr><tr><td align="center" valign="top"><p>1:15</p></td><td align="left" valign="top"><p><code class="literal">POST0_15</code></p></td><td align="center" valign="top"><p>14</p></td></tr><tr><td align="center" valign="top"><p>1:16</p></td><td align="left" valign="top"><p><code class="literal">POST0_16</code></p></td><td align="center" valign="top"><p>15</p></td></tr></tbody></table></div><p><br>
<br>
<br></p><p><span class="strong"><strong>Example:</strong></span></p><p>This code uses Timer 0 and On Interrupt to flash an LED.</p><pre class="screen">/*

Remember four things to setup a timer.

1.  InitTimer0 source, prescaler + clocksource, postscaler

2.  SetTimer (byte_value, value ), or
    SetTimer (word_value [where the High byte sets the timer], value )

3.  StartTimer 0

    and, optionally use

4.  ClearTimer 0

*/

    'Chip Settings.
    #CHIP 16f18313, 32

    Dir porta.1 Out

    'Setup the timer.
    '          Source, Prescaler  + Clock Source    , Postscaler
    InitTimer0 Osc,    PRE0_16384 + TMR0_HFINTOSC   , POST0_11

    ' Set the Timer start value.  Use the HIGH byte of the word when using an 8/16bit timer in 8 bit mode
    SetTimer ( 0, 0x5800 )

    ' Start the Timer by writing to TMR0ON bit
    StartTimer 0


    Do
        Wait While TMR0IF = 0
        ' Clearing timer flag
        TMR0IF = 0
        porta.1 = ! porta.1

    Loop</pre><p><span class="strong"><strong>Supported in &lt;TIMER.H&gt;</strong></span></p><p>See also  see: <a class="link" href="_inittimer0.html" title="InitTimer0">InitTimer0</a> for microcontroller with only an 8 bit Timer 0 module.</p></div></body></html>