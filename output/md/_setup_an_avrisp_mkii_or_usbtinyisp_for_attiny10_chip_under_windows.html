<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Setup an AVRISP MKII or USBtinyISP for ATTINY10 chip under Windows</title><link rel="stylesheet" type="text/css" href="gcbdoc.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="GCBASIC documentation"><link rel="up" href="_gcbasic_with_the_avrisp_or_mkii_programmer.html" title="GCBASIC with the AVRISP or MKII Programmer"><link rel="prev" href="_gcbasic_with_the_avrisp_or_mkii_programmer.html" title="GCBASIC with the AVRISP or MKII Programmer"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_setup_an_avrisp_mkii_or_usbtinyisp_for_attiny10_chip_under_windows"></a>Setup an AVRISP MKII or USBtinyISP for ATTINY10 chip under Windows</h3></div></div></div><p><span class="strong"><strong>AVRISP MKII Windows Driver Validation/Changing</strong></span></p><p>Windows 10 and 11 tested.</p><p>When using the AVRDUDE, which is used as part of the GCBASIC toolchain, you need to ensure these programmers are operating with the correct Windows device driver.&nbsp;&nbsp;
The Windows driver must be <code class="literal">libusbK</code> not <code class="literal">libusb or libusb-win32</code> Windows driver.</p><p>You must ensure the Windows driver is <code class="literal">libusbK</code>.&nbsp;&nbsp;Using the utility Zadig enables changing the Windows device driver to <code class="literal">libusbK</code>.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Download and install Zadig Driver Utility software <a class="link" href="https://zadig.akeo.ie/" target="_top">https://zadig.akeo.ie/</a></li><li class="listitem">Connect the USB cable from the AVRISP MKII to your PC.</li><li class="listitem">Open Zadig and from the menu select Options / List All Devices.</li><li class="listitem">From the device list select AVRISP MKII.</li><li class="listitem">Select the target driver libusbK and click (Install / Replace Driver) button.</li></ul></div><p>After the installation is completed, open Windows Device Manager and verify the driver installation.</p><p>Close Zadig</p><div class="informalfigure"><div class="mediaobject"><img src="./images/1%20%20-%20AVRISP%20MKII%20Zadig%20Setup.png" alt="Setup"></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>If you use ATMEL Studio you must ensure the Windows device driver is <code class="literal">libusb or libusb-win32</code>.</p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>If you use AVRDUDE then uou must ensure the Windows device driver is <code class="literal">libusbK</code>.</p></div><p>Next in the process is to upgrade the firmware of the AVRISP MKII.</p><p><span class="strong"><strong>Option 1:</strong></span></p><p>This process shows the installation of Atmel Studio 7, however, you may have to use Atmel Studio 6 because of operation system constraint.</p><p>Download and Install Atmel Studio 7 from the GCBASIC file store <a class="link" href="https://sourceforge.net/projects/gcbasic/files/Support%20Files/ATMELCompilers/" target="_top">here</a></p><p>After the installation open ATMEL STUDIO 7</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Select Tools / Device Programming</li><li class="listitem">Make sure the AVRISP MKII is selected</li><li class="listitem">At this point ATMEL STUDIO will notified to upgrade the firmware to version 1.8</li><li class="listitem">Click the Upgrade  button</li><li class="listitem">Once the firmware is upgraded, close ATMEL STUDIO 7</li></ul></div><div class="informalfigure"><div class="mediaobject"><img src="./images/2%20%20-%20ATMEL%20STUDIO.png" alt="Studio"></div></div><p><br>
<br></p><p><span class="strong"><strong>Option 2:</strong></span></p><p>To update the firmware please, follow the steps listed below.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Connect the programmer to the USB and with a sharp object (needle or pin) press the upgrade pin - it is in a small hole at the back of the board (this will start the bootloader and will turn off the LED, it will also probably show a new unrecognized device in the device manager for which we will install drivers in step 3)</li><li class="listitem">Download and install the latest version of "Atmel Flip" software (it can be downloaded from the Atmel&#8217;s web-site, or from the GCBASIC file store <a class="link" href="https://sourceforge.net/projects/gcbasic/files/Support%20Files/ATMELCompilers/AVRISPMk2/" target="_top">here</a> )</li><li class="listitem">Open its install folder and update the software of the unrecognized device (usually under the "Other devices" tab) with the drivers from folder named "usb"; the device should now be recognized as AT90USB162 under "libusb-win32" tab</li><li class="listitem">Start "Atmel FLIP" and click "Select a target device" &#8594; choose AT90USB162</li><li class="listitem">Click "Select a Communication Medium" and then USB medium</li><li class="listitem">Download the firware and unpack <a class="link" href="https://www.olimex.com/Products/AVR/Programmers/AVR-ISP-MK2/resources/AVR456-studio-AVRISP-MKII.zip" target="_top">Olimex website</a> or the GCBASIC files store <a class="link" href="https://sourceforge.net/projects/gcbasic/files/Support%20Files/ATMELCompilers/AVRISPMk2/" target="_top">here</a></li><li class="listitem">From "File &#8594; load HEX file" choose the latest HEX and click "RUN" in the "Operations Flow" section</li><li class="listitem">Disconnect the AVR-ISP-MK2 from the USB and connect it again</li></ul></div><p>For more information about AVR-ISP-MK2 see this guide <a class="link" href="http://gcbasic.sourceforge.net/library/AVR-ISP-MK2-OpenSourceHardwareBoard.pdf" target="_top">here</a></p><p><span class="strong"><strong>AVRISP MKII to ATTINY10 Connections:</strong></span></p><p>Connect the AVRISP MKII to the ATTINY10 as show in the Diagram.</p><div class="informalfigure"><div class="mediaobject"><img src="./images/3%20%20-%20AVRISP%20MKII%20Connections.png" alt="Connections"></div></div><p><br>
<br></p><p><span class="strong"><strong>GCStudio Programmer Setup:</strong></span></p><p>Open GCStudio and set the Programmers to use as show below</p><p>For AVRISP MKII use the AVR ISP XPII [KANDA] and drag it to the top of the list and click OK.</p><div class="informalfigure"><div class="mediaobject"><img src="./images/4%20%20-%20GCStudio%20AVRISP%20MKII%20use%20the%20AVR%20ISP%20XPII%20%5BKANDA%5D.png" alt="4%20%20 %20GCStudio%20AVRISP%20MKII%20use%20the%20AVR%20ISP%20XPII%20%5BKANDA%5D"></div></div><p><br>
<br></p><p>Now you&#8217;re ready to upload your first program to an ATTINY10.</p><p><span class="strong"><strong>USBtinyISP Setup:</strong></span></p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">From Zadig select USBtinyISP in the device list.</li><li class="listitem">Select the target driver libusb-win32 and click (Install / Replace Driver) button.</li><li class="listitem">After the installation, open Windows Device Manager and verify the driver installation.</li><li class="listitem">Close ZADIG</li></ul></div><div class="informalfigure"><div class="mediaobject"><img src="./images/5%20%20-%20USBtinyISP%20Zadig%20setup.png" alt="5%20%20 %20USBtinyISP%20Zadig%20setup"></div></div><p><br>
<br></p><p><span class="strong"><strong>USBtinyISP to ATTINY10 Connections:</strong></span></p><p>Connect the USBtinyISP to the ATTINY10 as show in the Diagram.</p><div class="informalfigure"><div class="mediaobject"><img src="./images/6%20%20-%20USBtinyISP%20Copnections.png" alt="6%20%20 %20USBtinyISP%20Copnections"></div></div><p><br>
<br></p><p><span class="strong"><strong>GCStudio Programmer Setup:</strong></span></p><p>Open GCStudio and set the Programmers to use as show below</p><p>Select and Drag  the Avrdude (USBtinyISP) programmer to the top of the list.</p><div class="informalfigure"><div class="mediaobject"><img src="./images/7%20%20-%20GCStudio%20Avrdude%20%28USBtinyISP%29.png" alt="7%20%20 %20GCStudio%20Avrdude%20%28USBtinyISP%29"></div></div><p><br>
<br></p><p>Now you are ready to upload your first program to an ATTINY10</p><p>For more information programming review these resources:</p><pre class="literallayout">A guide http://gcbasic.sourceforge.net/library/Programming_an_Attiny10_with_AVRISP_mkII_and_AVR_Studio_5.pdf[here]</pre><pre class="literallayout">A blog http://gcbasic.sourceforge.net/library/Technoblogy_Programming_the_ATtiny10.pdf[here]</pre><p><br>
<br></p></div></body></html>